(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    150566,       3252]
NotebookOptionsPosition[    145612,       3086]
NotebookOutlinePosition[    146150,       3106]
CellTagsIndexPosition[    146107,       3103]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Modeling by Mark Yeatman
mxy110230@utdallas.edu
Sept 2019\
\>", "Subsubtitle",
 CellChangeTimes->{{3.5111737331439896`*^9, 3.511173737039212*^9}, {
  3.520768651078125*^9, 3.520768659875*^9}, {3.521818801734375*^9, 
  3.521818813484375*^9}, {3.543075080431307*^9, 3.5430750818223066`*^9}, {
  3.555090980418681*^9, 3.5550909814106812`*^9}, {3.5870545444315977`*^9, 
  3.5870545499091454`*^9}, {3.763919879566497*^9, 3.7639199143025894`*^9}, {
  3.7779151244623256`*^9, 3.7779151349803295`*^9}}],

Cell[CellGroupData[{

Cell["Initialization", "Section",
 CellChangeTimes->{{3.587054562815436*^9, 3.5870545683829927`*^9}, 
   3.7639210008236065`*^9, {3.763922322016376*^9, 3.763922332416171*^9}, {
   3.7685736312280703`*^9, 3.768573641896326*^9}, {3.7778182597402086`*^9, 
   3.777818268541385*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{
    RowBox[{"General", "::", "spell"}], ",", 
    RowBox[{"General", "::", "spell1"}], ",", 
    StyleBox[
     RowBox[{"Get", "::", "noopen"}], "MessageName"], 
    StyleBox[",", "MessageName"], 
    StyleBox[
     RowBox[{"Needs", "::", "nocont"}], "MessageName"]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Screws`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<RobotLinks`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ToMatlab`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindFile", "[", "\"\<Screws`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindFile", "[", "\"\<RobotLinks`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindFile", "[", "\"\<ToMatlab`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"_", "\[Element]", "Reals"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.807027459271763*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"EndPackage", "::", "noctx"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"No previous context defined. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/EndPackage/noctx\\\", ButtonNote -> \
\\\"EndPackage::noctx\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{{3.807031814915515*^9, 3.8070318425227575`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Open Chain Kinematics (COP Reference Frame)", "Section",
 CellChangeTimes->{{3.587054562815436*^9, 3.5870545683829927`*^9}, 
   3.7639210008236065`*^9, {3.763922322016376*^9, 3.763922332416171*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", "[", "t", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2", "[", "t", "]"}], "}"}]}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"knee", " ", "angle"}], ",", " ", 
    RowBox[{"ankle", " ", "angle"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xdot", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"x", ",", "t"}], "]"}]}], ";", " ", 
  RowBox[{"xddot", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"xdot", ",", "t"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.5111737472017937`*^9, {3.511173782073788*^9, 3.5111737868600616`*^9}, {
   3.5111755940464272`*^9, 3.511175600408791*^9}, {3.520686131703125*^9, 
   3.520686135875*^9}, {3.520686309671875*^9, 3.520686312484375*^9}, {
   3.520687115453125*^9, 3.5206871275625*^9}, {3.52078867884375*^9, 
   3.52078872540625*^9}, {3.520857852828125*^9, 3.520857856765625*^9}, {
   3.521820034578125*^9, 3.52182003665625*^9}, {3.521820194515625*^9, 
   3.52182019925*^9}, {3.521911060609375*^9, 3.52191106496875*^9}, 
   3.5219945113125*^9, {3.523028145328125*^9, 3.523028147203125*^9}, 
   3.523028568734375*^9, {3.523033556203125*^9, 3.5230335580625*^9}, {
   3.52303366240625*^9, 3.523033664046875*^9}, {3.5232996586875*^9, 
   3.523299669890625*^9}, 3.523299712796875*^9, {3.52330022171875*^9, 
   3.523300234421875*^9}, {3.52330028559375*^9, 3.52330029028125*^9}, 
   3.5233008249375*^9, {3.523360415484375*^9, 3.523360421828125*^9}, {
   3.523380309234375*^9, 3.52338031990625*^9}, {3.523380358796875*^9, 
   3.523380364234375*^9}, {3.5287165611401763`*^9, 3.5287165746088295`*^9}, {
   3.543073868103307*^9, 3.543073894812307*^9}, 3.5430739902623067`*^9, {
   3.5430742662443066`*^9, 3.543074273445307*^9}, 3.5430744729683065`*^9, {
   3.5430748729733067`*^9, 3.5430748749423065`*^9}, {3.555095285078673*^9, 
   3.5550952976686726`*^9}, {3.5553255793781047`*^9, 3.555325590112178*^9}, 
   3.5559492285885787`*^9, {3.587054558588013*^9, 3.587054560969251*^9}, {
   3.7639210046785345`*^9, 3.763921006646368*^9}, {3.7639223376326623`*^9, 
   3.7639223408171253`*^9}, {3.7639888827120976`*^9, 3.763988883260669*^9}, {
   3.7639889168895807`*^9, 3.7639889213377137`*^9}, {3.779450916264507*^9, 
   3.7794509496944666`*^9}, 3.779454858414114*^9, {3.7888939847217913`*^9, 
   3.7888939851688175`*^9}, {3.789135603001992*^9, 3.789135603770023*^9}, {
   3.7894053444576626`*^9, 3.7894053552674913`*^9}, {3.7894054043724403`*^9, 
   3.789405412657139*^9}, {3.807026667434965*^9, 3.8070266746637897`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x1", "[", "t", "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x2", "[", "t", "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.788894758176518*^9, 3.7888948346245923`*^9, 3.7888949137880135`*^9, 
   3.7888951701123247`*^9, 3.7888954071779733`*^9, 3.7891324372348046`*^9, 
   3.7891331168841276`*^9, 3.789135611719898*^9, 3.7891430468548746`*^9, 
   3.7893197052529306`*^9, 3.7894058331469293`*^9, 3.7894059033647385`*^9, 
   3.78940600567448*^9, 3.7894062092643223`*^9, {3.789406284048826*^9, 
   3.7894063065907364`*^9}, 3.7894064617455397`*^9, 3.7894891261157618`*^9, 
   3.789489279835597*^9, 3.7894893794656496`*^9, {3.8070273380005083`*^9, 
   3.8070273667708263`*^9}, {3.8070274943978353`*^9, 
   3.8070275172273436`*^9}, {3.8070275483779497`*^9, 3.8070275721656294`*^9}, 
   3.807029329736303*^9, 3.807029412780403*^9, {3.807029473582815*^9, 
   3.80702951057539*^9}, 3.8070296387328835`*^9, {3.8070297009391623`*^9, 
   3.807029741524336*^9}, {3.807029782555473*^9, 3.807029811006596*^9}, 
   3.807030849764533*^9, 3.807030928633786*^9, 3.8070310018849897`*^9, 
   3.807031603010688*^9, {3.8070318053089266`*^9, 3.807031842688753*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"ax1", " ", "=", " ", 
    RowBox[{"RevoluteTwist", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"knee", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ax2", " ", "=", " ", 
    RowBox[{"RevoluteTwist", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "ls"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"ankle", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"axzero", " ", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e1", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax1", ",", 
      RowBox[{"x1", "[", "t", "]"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e2", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax2", ",", 
      RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.520686144890625*^9, 3.520686145203125*^9}, {
   3.52068617653125*^9, 3.520686205625*^9}, {3.520686284921875*^9, 
   3.520686305984375*^9}, {3.520686374484375*^9, 3.520686441609375*^9}, {
   3.52068650903125*^9, 3.520686509140625*^9}, {3.52068656871875*^9, 
   3.520686617546875*^9}, {3.5206873421875*^9, 3.520687418140625*^9}, {
   3.5207688911875*^9, 3.520768891421875*^9}, {3.5208577891875*^9, 
   3.5208577938125*^9}, {3.52182001190625*^9, 3.521820023734375*^9}, {
   3.521911082890625*^9, 3.52191115175*^9}, {3.52191125971875*^9, 
   3.521911294796875*^9}, {3.521911335375*^9, 3.5219113548125*^9}, {
   3.5219119563125*^9, 3.521911956390625*^9}, {3.521994532609375*^9, 
   3.521994535875*^9}, {3.52206939596875*^9, 3.5220694045625*^9}, {
   3.523028084703125*^9, 3.523028115890625*^9}, 3.523028291140625*^9, 
   3.523033323140625*^9, 3.523033450765625*^9, {3.52303353259375*^9, 
   3.5230335539375*^9}, {3.5230373085*^9, 3.52303737340625*^9}, {
   3.523037467328125*^9, 3.52303746903125*^9}, 3.52330047*^9, {
   3.523358999328125*^9, 3.52335906684375*^9}, {3.523360273125*^9, 
   3.523360357953125*^9}, {3.5233608009375*^9, 3.523360804421875*^9}, {
   3.52336423246875*^9, 3.52336423984375*^9}, 3.528716608959394*^9, {
   3.5378114879773455`*^9, 3.5378114882175856`*^9}, {3.539014808319905*^9, 
   3.5390148139360275`*^9}, {3.543073943307307*^9, 3.543074019945307*^9}, {
   3.5430740586903067`*^9, 3.543074064726307*^9}, {3.543075246569307*^9, 
   3.5430752470013065`*^9}, {3.5431422985871916`*^9, 3.543142308314192*^9}, {
   3.5439277592067757`*^9, 3.5439277644517756`*^9}, {3.5439278106917753`*^9, 
   3.5439278108357754`*^9}, {3.5551529968463793`*^9, 3.555153041439379*^9}, {
   3.5553255954747143`*^9, 3.555325607990966*^9}, {3.555949225987579*^9, 
   3.5559492261145787`*^9}, 3.763920382649495*^9, {3.7779154880375853`*^9, 
   3.777915489791995*^9}, {3.7779155558626766`*^9, 3.777915584522359*^9}, {
   3.7779156312055073`*^9, 3.777915668341381*^9}, {3.7794509614240685`*^9, 
   3.7794509643940334`*^9}, {3.7888939477448034`*^9, 
   3.7888939976487913`*^9}, {3.788894043904642*^9, 3.7888940441286693`*^9}, {
   3.78913556673139*^9, 3.789135569212396*^9}, {3.789405366657712*^9, 
   3.7894054011573143`*^9}, {3.7894055794367576`*^9, 3.789405601826569*^9}, {
   3.789489275106629*^9, 3.7894892752786713`*^9}, {3.807026695420961*^9, 
   3.807026767664922*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Reference", " ", "Configuration"}], "*)"}], " ", 
  RowBox[{"(*", 
   RowBox[{
   "With", " ", "Inertial", " ", "Reference", " ", "Frame", " ", "Origin", 
    " ", "at", " ", "Knee"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Initial", " ", "Configuration", " ", "of", " ", "Centers", " ", "of", " ",
     "Mass"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"gst00", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "lt"}], "/", "2"}], ",", "0"}], "}"}]}], "]"}]}], ";", 
    "   ", 
    RowBox[{"(*", 
     RowBox[{"shank", " ", "CoM", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"gst01", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"lfx", ",", 
         RowBox[{
          RowBox[{"-", "lt"}], "-", "lfy"}], ",", "0"}], "}"}]}], "]"}]}], 
    ";", "  ", 
    RowBox[{"(*", 
     RowBox[{"foot", " ", "CoM", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Initial", " ", "Configuration", " ", "of", " ", "Joints"}], 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{"gp0", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";", "  ", 
    RowBox[{"(*", 
     RowBox[{"knee", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"gp1", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "lt"}], ",", "0"}], "}"}]}], "]"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"ankle", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Initital", " ", "Configuration", " ", "of", " ", "Load", " ", "Cell"}], 
    "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.52068675271875*^9, 3.5206868401875*^9}, {
   3.52068688309375*^9, 3.520686884765625*^9}, {3.5206869316875*^9, 
   3.52068695546875*^9}, {3.52068703525*^9, 3.5206870995*^9}, {
   3.52068721059375*^9, 3.5206872309375*^9}, {3.520687329875*^9, 
   3.520687335984375*^9}, {3.520687447921875*^9, 3.520687482640625*^9}, {
   3.52085775021875*^9, 3.5208577569375*^9}, {3.52182002690625*^9, 
   3.521820029890625*^9}, {3.52199454090625*^9, 3.5219945435625*^9}, {
   3.521994576609375*^9, 3.521994577125*^9}, 3.522069407859375*^9, {
   3.52302817175*^9, 3.52302817784375*^9}, {3.52302821046875*^9, 
   3.523028219296875*^9}, {3.52302827453125*^9, 3.523028289421875*^9}, {
   3.52303357528125*^9, 3.523033624796875*^9}, {3.5232999903125*^9, 
   3.523300034796875*^9}, {3.52330072346875*^9, 3.52330075775*^9}, {
   3.5387617592355986`*^9, 3.538761759396615*^9}, {3.5387617916248374`*^9, 
   3.5387617925049257`*^9}, {3.543074082165307*^9, 3.543074148335307*^9}, {
   3.543074210203307*^9, 3.5430743652183065`*^9}, {3.543074567731307*^9, 
   3.543074573234307*^9}, {3.5551530722213793`*^9, 3.555153123128379*^9}, {
   3.5551548714599023`*^9, 3.555154880689748*^9}, {3.7638166935451756`*^9, 
   3.76381674183117*^9}, {3.7639203529556055`*^9, 3.7639203532584653`*^9}, 
   3.777915741587598*^9, {3.777915829761903*^9, 3.7779159177626963`*^9}, {
   3.7779159515282807`*^9, 3.777916003113441*^9}, {3.7779160400165005`*^9, 
   3.777916110144987*^9}, {3.7779161407274213`*^9, 3.777916143287918*^9}, {
   3.7779195888114386`*^9, 3.7779197056350513`*^9}, {3.777919750640922*^9, 
   3.777919834642557*^9}, {3.777919896262021*^9, 3.777920009221264*^9}, {
   3.77824242292951*^9, 3.778242429459546*^9}, {3.779450970274663*^9, 
   3.7794509909440484`*^9}, {3.779451074414469*^9, 3.779451076344076*^9}, {
   3.7888940070407314`*^9, 3.7888941084974794`*^9}, {3.7891318513629436`*^9, 
   3.7891319048504467`*^9}, {3.7891319924343557`*^9, 3.789131992929347*^9}, {
   3.7891355718843565`*^9, 3.7891355933561063`*^9}, {3.789143014577739*^9, 
   3.7891430312648053`*^9}, {3.789405436562293*^9, 3.789405450867075*^9}, {
   3.7894054862071376`*^9, 3.7894054908069744`*^9}, {3.807026769998951*^9, 
   3.8070267842619*^9}, {3.8070268844001536`*^9, 3.8070269747300005`*^9}, {
   3.807027513896099*^9, 3.807027514270362*^9}, {3.807030674621166*^9, 
   3.8070307102191257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gpc", " ", "=", " ", 
    RowBox[{"RPToHomogeneous", "[", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"-", "lt"}], "-", "lc"}], ",", "0"}], "}"}]}], "]"}]}], 
   ";"}], "  ", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.807030721510391*^9, 3.8070307483310814`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Positions", " ", "of", " ", 
    RowBox[{"COM", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"expShank", " ", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "gst00"}], " ", "//", "FullSimplify"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"expFoot", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "gst01"}], " ", "//", "FullSimplify"}]}],
      "]"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Positions", " ", "of", " ", 
     RowBox[{"Joints", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"expKnee", " ", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "gp0"}], " ", "//", "FullSimplify"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"expAnkle", " ", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "gp1"}], "//", "FullSimplify"}]}], "]"}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Positions", " ", "of", " ", "Load", " ", "Cell"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"expCell", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "gpc"}], "//", "FullSimplify"}]}], "]"}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.777916229424477*^9, 3.777916270381218*^9}, {
   3.7779163127880306`*^9, 3.777916347846925*^9}, {3.777917702260448*^9, 
   3.7779177166249943`*^9}, {3.777920031602582*^9, 3.777920129651227*^9}, {
   3.778242379154322*^9, 3.778242436913762*^9}, {3.779450995034585*^9, 
   3.779450995504221*^9}, 3.7794510822041583`*^9, 3.779451494973237*^9, {
   3.779451715032281*^9, 3.7794517162701*^9}, {3.7888939101777906`*^9, 
   3.7888939120167975`*^9}, {3.788894113681466*^9, 3.7888941458884444`*^9}, {
   3.7891319195541277`*^9, 3.789132000289261*^9}, 3.7891321509286947`*^9, {
   3.7894055146373243`*^9, 3.7894055296045446`*^9}, {3.789405610756324*^9, 
   3.789405613856591*^9}, 3.7894892584637537`*^9, {3.807026986504525*^9, 
   3.8070270143456106`*^9}, {3.8070306406114078`*^9, 3.807030657242874*^9}, {
   3.8070307125950336`*^9, 3.8070307129630337`*^9}, {3.807030750451663*^9, 
   3.8070307506186557`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Positions", " ", "of", " ", "Joint", " ", "Points"}], ",", " ", 
    RowBox[{"Twist", " ", "Coordinates"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"twKnee", " ", "=", " ", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"HomogeneousToTwist", "[", "expKnee", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "1"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"twAnkle", " ", "=", " ", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"HomogeneousToTwist", "[", "expAnkle", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "1"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7779204525493727`*^9, 3.777920501484518*^9}, {
   3.777923446877672*^9, 3.7779235163681517`*^9}, {3.777923572661972*^9, 
   3.7779236477617826`*^9}, {3.7782424648648305`*^9, 
   3.7782424700181203`*^9}, {3.7794511037436476`*^9, 3.7794511069439173`*^9}, 
   3.788893925153881*^9, {3.788894152320421*^9, 3.7888942140487027`*^9}, {
   3.789132047744733*^9, 3.7891320774085145`*^9}, {3.789132146510707*^9, 
   3.7891321546566567`*^9}, {3.8070270273772373`*^9, 3.8070270277222414`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Screws", "::", "notTwistMatrix"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"-- Message text not found -- \
(\[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"HomogeneousToTwist\\\\\\\"\\\"}]\\)\
\[NoBreak])\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.789132438928788*^9, 3.789133118267143*^9, 3.7891356129748807`*^9, 
   3.7891430476038885`*^9, 3.7893197060526004`*^9, 3.789405834235197*^9, 
   3.789405905216855*^9, 3.789406006584433*^9, 3.7894062102143006`*^9, {
   3.7894062850768185`*^9, 3.7894063075647044`*^9}, 3.7894064629685335`*^9, 
   3.7894891272327533`*^9, 3.789489280344593*^9, 3.7894893806586547`*^9, {
   3.8070273389354997`*^9, 3.8070273675278196`*^9}, {3.807027494947833*^9, 
   3.8070275177403793`*^9}, {3.807027548735977*^9, 3.807027572544628*^9}, 
   3.807029330525313*^9, 3.807029413423413*^9, {3.807029474227837*^9, 
   3.8070295112333655`*^9}, 3.8070296393758774`*^9, {3.8070297015811543`*^9, 
   3.8070297421853294`*^9}, {3.8070297832094665`*^9, 3.80702981173559*^9}, 
   3.8070308505135345`*^9, 3.8070309293938093`*^9, 3.8070310026415076`*^9, 
   3.807031603763706*^9, {3.807031806295891*^9, 3.8070318434737473`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Screws", "::", "wrongDimension"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"-- Message text not found --\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{
  3.789132438928788*^9, 3.789133118267143*^9, 3.7891356129748807`*^9, 
   3.7891430476038885`*^9, 3.7893197060526004`*^9, 3.789405834235197*^9, 
   3.789405905216855*^9, 3.789406006584433*^9, 3.7894062102143006`*^9, {
   3.7894062850768185`*^9, 3.7894063075647044`*^9}, 3.7894064629685335`*^9, 
   3.7894891272327533`*^9, 3.789489280344593*^9, 3.7894893806586547`*^9, {
   3.8070273389354997`*^9, 3.8070273675278196`*^9}, {3.807027494947833*^9, 
   3.8070275177403793`*^9}, {3.807027548735977*^9, 3.807027572544628*^9}, 
   3.807029330525313*^9, 3.807029413423413*^9, {3.807029474227837*^9, 
   3.8070295112333655`*^9}, 3.8070296393758774`*^9, {3.8070297015811543`*^9, 
   3.8070297421853294`*^9}, {3.8070297832094665`*^9, 3.80702981173559*^9}, 
   3.8070308505135345`*^9, 3.8070309293938093`*^9, 3.8070310026415076`*^9, 
   3.807031603763706*^9, {3.807031806295891*^9, 3.8070318436067495`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Screws", "::", "notTwistMatrix"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"-- Message text not found -- \
(\[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"HomogeneousToTwist\\\\\\\"\\\"}]\\)\
\[NoBreak])\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.789132438928788*^9, 3.789133118267143*^9, 3.7891356129748807`*^9, 
   3.7891430476038885`*^9, 3.7893197060526004`*^9, 3.789405834235197*^9, 
   3.789405905216855*^9, 3.789406006584433*^9, 3.7894062102143006`*^9, {
   3.7894062850768185`*^9, 3.7894063075647044`*^9}, 3.7894064629685335`*^9, 
   3.7894891272327533`*^9, 3.789489280344593*^9, 3.7894893806586547`*^9, {
   3.8070273389354997`*^9, 3.8070273675278196`*^9}, {3.807027494947833*^9, 
   3.8070275177403793`*^9}, {3.807027548735977*^9, 3.807027572544628*^9}, 
   3.807029330525313*^9, 3.807029413423413*^9, {3.807029474227837*^9, 
   3.8070295112333655`*^9}, 3.8070296393758774`*^9, {3.8070297015811543`*^9, 
   3.8070297421853294`*^9}, {3.8070297832094665`*^9, 3.80702981173559*^9}, 
   3.8070308505135345`*^9, 3.8070309293938093`*^9, 3.8070310026415076`*^9, 
   3.807031603763706*^9, {3.807031806295891*^9, 3.8070318437527494`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Screws", "::", "wrongDimension"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"-- Message text not found --\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{
  3.789132438928788*^9, 3.789133118267143*^9, 3.7891356129748807`*^9, 
   3.7891430476038885`*^9, 3.7893197060526004`*^9, 3.789405834235197*^9, 
   3.789405905216855*^9, 3.789406006584433*^9, 3.7894062102143006`*^9, {
   3.7894062850768185`*^9, 3.7894063075647044`*^9}, 3.7894064629685335`*^9, 
   3.7894891272327533`*^9, 3.789489280344593*^9, 3.7894893806586547`*^9, {
   3.8070273389354997`*^9, 3.8070273675278196`*^9}, {3.807027494947833*^9, 
   3.8070275177403793`*^9}, {3.807027548735977*^9, 3.807027572544628*^9}, 
   3.807029330525313*^9, 3.807029413423413*^9, {3.807029474227837*^9, 
   3.8070295112333655`*^9}, 3.8070296393758774`*^9, {3.8070297015811543`*^9, 
   3.8070297421853294`*^9}, {3.8070297832094665`*^9, 3.80702981173559*^9}, 
   3.8070308505135345`*^9, 3.8070309293938093`*^9, 3.8070310026415076`*^9, 
   3.807031603763706*^9, {3.807031806295891*^9, 3.8070318439017506`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Velocities", " ", "of", " ", "Joint", " ", "Points"}], ",", " ", 
    RowBox[{"Homogenous", " ", "Coordinates"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"vKnee", "=", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"twKnee", " ", ",", "t"}], "]"}], "//", "FullSimplify"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"vAnkle", "=", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"twAnkle", ",", "t"}], "]"}], "//", "FullSimplify"}]}], "]"}],
     ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7891321669615183`*^9, 3.789132194671665*^9}, {
  3.8070270336969423`*^9, 3.807027034168971*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Joint", " ", "Jacobians"}], ",", " ", 
    RowBox[{
    "to", " ", "get", " ", "xyz", " ", "velocities", " ", "in", " ", 
     "worldframe"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Js0", " ", "=", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"twKnee", " ", ",", 
          RowBox[{"{", "x", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "6"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Js1", " ", "=", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"twAnkle", "  ", ",", 
          RowBox[{"{", "x", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "6"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.777923706659791*^9, 3.7779237565195713`*^9}, 
   3.7794511114839897`*^9, {3.788894223923712*^9, 3.7888942306085463`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"J0", " ", "=", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"x1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"axzero", " ", ",", 
        RowBox[{"x2", "[", "t", "]"}]}], "}"}], ",", "gst00"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J1", " ", "=", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"x1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"x2", "[", "t", "]"}]}], "}"}], ",", "gst01"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Jc", " ", "=", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"x1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"x2", "[", "t", "]"}]}], "}"}], ",", "gpc"}], "]"}], "//", 
    "FullSimplify"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5111738617903476`*^9, 3.5111738667576323`*^9}, {
   3.520687517765625*^9, 3.520687540921875*^9}, {3.520687606828125*^9, 
   3.5206876815*^9}, {3.520687776859375*^9, 3.520687825828125*^9}, {
   3.5207672543125*^9, 3.52076725465625*^9}, {3.520857785640625*^9, 
   3.520857819140625*^9}, {3.521820049171875*^9, 3.5218200495*^9}, {
   3.521820085109375*^9, 3.521820108265625*^9}, {3.52191142990625*^9, 
   3.521911483640625*^9}, {3.52199456603125*^9, 3.52199457315625*^9}, {
   3.52302830015625*^9, 3.523028386578125*^9}, {3.523300027125*^9, 
   3.523300057609375*^9}, {3.5430744013273067`*^9, 3.543074418830307*^9}, {
   3.543074460187307*^9, 3.543074460955307*^9}, {3.543074502201307*^9, 
   3.543074505464307*^9}, {3.543074580212307*^9, 3.5430745997753067`*^9}, {
   3.555153147493379*^9, 3.5551532493003793`*^9}, {3.5551548940954285`*^9, 
   3.5551548980572205`*^9}, {3.5553256191800847`*^9, 3.555325646525819*^9}, {
   3.7366939243363523`*^9, 3.7366939259987993`*^9}, 3.7404900754748125`*^9, 
   3.763816558600665*^9, {3.7779163883742123`*^9, 3.7779164686741476`*^9}, {
   3.7794511604943323`*^9, 3.779451176903656*^9}, {3.788894234592539*^9, 
   3.7888942407844353`*^9}, {3.789405645351391*^9, 3.789405670976184*^9}, {
   3.7894891195698013`*^9, 3.7894891196838126`*^9}, {3.8070270407607155`*^9, 
   3.8070270589122148`*^9}, {3.807030796178939*^9, 3.807030824691286*^9}, {
   3.8070309138365974`*^9, 3.8070309188282957`*^9}, {3.807031824913759*^9, 
   3.8070318332327604`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"lc", "-", "ls", "+", "lt", "+", 
       RowBox[{"ls", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x2", "[", "t", "]"}], "]"}]}]}], 
      RowBox[{"lc", "-", "ls", "+", "lt"}]},
     {
      RowBox[{
       RowBox[{"-", "ls"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x2", "[", "t", "]"}], "]"}]}], "0"},
     {"0", "0"},
     {"0", "0"},
     {"0", "0"},
     {"1", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8070309302218065`*^9, 3.8070310034945126`*^9, 3.8070316045676947`*^9, {
   3.807031806941918*^9, 3.8070318443317766`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Velocities", " ", "of", " ", "Joint", " ", "Points"}], ",", " ", 
   RowBox[{"Homogenous", " ", "Coordinates"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.777916507458903*^9, 3.777916525073671*^9}, {
  3.7779166027515197`*^9, 3.777916603423485*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dynamics", "Section",
 CellChangeTimes->{{3.521995144125*^9, 3.521995144875*^9}, {
   3.526060014172608*^9, 3.5260600152917194`*^9}, {3.543078143146307*^9, 
   3.543078144569307*^9}, 3.5431473723201914`*^9}],

Cell[CellGroupData[{

Cell["Mass Matrix", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.7638166458802586`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"genM0", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ms", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Ms", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Ms", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genM1", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"Mf", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "Mf", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Mf", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7638166156113358`*^9, 3.763816620939521*^9}, {
  3.7779165478146257`*^9, 3.7779165675155616`*^9}, {3.777916658006153*^9, 
  3.777916678197755*^9}, {3.7779167259496555`*^9, 3.777916846732939*^9}, {
  3.7779168813903055`*^9, 3.7779168959133525`*^9}, {3.7794511813139153`*^9, 
  3.7794511820739923`*^9}, {3.788894247827385*^9, 3.788894263857342*^9}, {
  3.7888943587372084`*^9, 3.788894362752185*^9}, {3.7894056926912575`*^9, 
  3.789405717865909*^9}, {3.8070270656084146`*^9, 3.80702706717741*^9}, {
  3.8070309892324533`*^9, 3.807030992467888*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Mmatrix", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "J0", "]"}], ".", "genM0", ".", "J0"}], "+", 
     RowBox[{
      RowBox[{"Transpose", "[", "J1", "]"}], ".", "genM1", ".", "J1"}]}]}], 
   "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7638166156113358`*^9, 3.763816620939521*^9}, 
   3.7779167291694345`*^9, {3.7794511882636256`*^9, 3.7794511885040607`*^9}, {
   3.7888943680321574`*^9, 3.7888943683531675`*^9}, {3.789406297135756*^9, 
   3.7894063033907537`*^9}, {3.807027127576153*^9, 3.80702712777812*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["lt", "2"], " ", "Ms"}], "4"], "+", 
       RowBox[{"Mf", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"lfy", "-", "ls", "+", "lt", "+", 
           RowBox[{"ls", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{"Mf", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"lfx", "-", 
           RowBox[{"ls", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}]}], ")"}], "2"]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"lfy", "-", "ls", "+", "lt"}], ")"}], " ", "Mf", " ", 
        RowBox[{"(", 
         RowBox[{"lfy", "-", "ls", "+", "lt", "+", 
          RowBox[{"ls", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x2", "[", "t", "]"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"lfx", " ", "Mf", " ", 
        RowBox[{"(", 
         RowBox[{"lfx", "-", 
          RowBox[{"ls", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"x2", "[", "t", "]"}], "]"}]}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"lfy", "-", "ls", "+", "lt"}], ")"}], " ", "Mf", " ", 
        RowBox[{"(", 
         RowBox[{"lfy", "-", "ls", "+", "lt", "+", 
          RowBox[{"ls", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x2", "[", "t", "]"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"lfx", " ", "Mf", " ", 
        RowBox[{"(", 
         RowBox[{"lfx", "-", 
          RowBox[{"ls", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"x2", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["lfx", "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"lfy", "-", "ls", "+", "lt"}], ")"}], "2"]}], ")"}], " ", 
       "Mf"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.777925135164068*^9, 3.779451640062377*^9, 3.7794517286657467`*^9, 
   3.7794518193921795`*^9, 3.7794521221852098`*^9, 3.779454878663997*^9, 
   3.779454923675926*^9, 3.7794549624470215`*^9, 3.7794550322207394`*^9, 
   3.7794558724164114`*^9, 3.7794560390929327`*^9, 3.788894762740507*^9, 
   3.7888948390695477`*^9, 3.7888949181989737`*^9, 3.788895174483285*^9, 
   3.7888954118596582`*^9, 3.7891324440657635`*^9, 3.7891331225410647`*^9, 
   3.78913561714287*^9, 3.789143050494916*^9, 3.789319708361747*^9, 
   3.789405837185083*^9, 3.7894059080470247`*^9, 3.7894060093046217`*^9, 
   3.7894062129704695`*^9, {3.789406287857804*^9, 3.7894063122806787`*^9}, 
   3.789406467204536*^9, 3.7894891355947075`*^9, 3.7894892833845773`*^9, 
   3.789489390293119*^9, {3.8070274960118265`*^9, 3.807027519018387*^9}, {
   3.8070275499009404`*^9, 3.807027573664652*^9}, 3.807029332126916*^9, 
   3.807029414947589*^9, {3.8070294757168083`*^9, 3.8070295128065677`*^9}, 
   3.8070296409158697`*^9, {3.807029703101149*^9, 3.8070297437823267`*^9}, {
   3.807029784749996*^9, 3.807029813249852*^9}, 3.8070308520640793`*^9, 
   3.807030930925809*^9, 3.8070310040485334`*^9, 3.8070316051227207`*^9, {
   3.8070318070859203`*^9, 3.8070318448487415`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7779878725408573`*^9, 3.777987907863311*^9}, 
   3.807027134041629*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["C Matrix", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.763816653783472*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"First", "[", 
  RowBox[{"Dimensions", "[", "x", "]"}], "]"}]], "Input"],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{
  3.7794549237259455`*^9, 3.779454962485878*^9, 3.7794550322856693`*^9, 
   3.77945587250333*^9, 3.7794560391332216`*^9, 3.7888947628464766`*^9, 
   3.7888948391755466`*^9, 3.788894918282978*^9, 3.788895174586315*^9, 
   3.788895411976635*^9, 3.789132444174729*^9, 3.789133122654064*^9, 
   3.789135617225836*^9, 3.789143050568923*^9, 3.789319708452943*^9, 
   3.7894058372101994`*^9, 3.789405908074725*^9, 3.78940600932471*^9, 
   3.789406212993864*^9, {3.7894062878798037`*^9, 3.789406312338678*^9}, 
   3.789406467329505*^9, 3.7894891356977096`*^9, 3.7894892835485773`*^9, 
   3.789489390394121*^9, {3.8070274960918264`*^9, 3.8070275190623875`*^9}, {
   3.8070275499399414`*^9, 3.807027573707622*^9}, 3.807029332239921*^9, 
   3.807029415075593*^9, {3.8070294758268013`*^9, 3.807029512940398*^9}, 
   3.8070296410588703`*^9, {3.8070297032051497`*^9, 3.8070297439174833`*^9}, {
   3.8070297848949914`*^9, 3.8070298133938475`*^9}, 3.8070308521690493`*^9, 
   3.807030931032774*^9, 3.8070310041725397`*^9, 3.8070316051627226`*^9, {
   3.8070318071698875`*^9, 3.8070318448877425`*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cmtx", "=", 
   RowBox[{"0", "*", 
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{"First", "[", 
      RowBox[{"Dimensions", "[", "x", "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"First", "[", 
     RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", 
      RowBox[{"First", "[", 
       RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Cmtx", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Mmatrix", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "t"}], "]"}], "]"}],
          "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"FullSimplify", "[", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Mmatrix", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], "-", 
              RowBox[{"FullSimplify", "[", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Mmatrix", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
             ")"}], " ", 
            RowBox[{"xdot", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"First", "[", 
              RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], "}"}]}], 
          "]"}]}], ")"}]}]}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.520791335*^9, 3.520791401109375*^9}, {
  3.520791435046875*^9, 3.52079155540625*^9}, {3.520791602453125*^9, 
  3.520791651296875*^9}, {3.5207916853125*^9, 3.520791710046875*^9}, {
  3.520857930671875*^9, 3.520857946375*^9}, {3.521820137609375*^9, 
  3.52182014315625*^9}, {3.52189796709375*^9, 3.521898017515625*^9}, {
  3.523028605546875*^9, 3.52302860590625*^9}, {3.523380346921875*^9, 
  3.52338035309375*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Cmtx", " ", "=", " ", 
  RowBox[{"Cmtx", "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.5207916539375*^9, 3.52079166959375*^9}, {
   3.520857961375*^9, 3.520857962796875*^9}, 3.740490029073041*^9, 
   3.7794549537462645`*^9, 3.779455032645787*^9, 3.807027579571681*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ls", " ", "Mf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "lfx"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"x2", "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"lfy", "-", "ls", "+", "lt"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"x2", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["x2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], ",", 
     RowBox[{"ls", " ", "Mf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "lfx"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"x2", "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"lfy", "-", "ls", "+", "lt"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"x2", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SuperscriptBox["x1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "+", 
        RowBox[{
         SuperscriptBox["x2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ls", " ", "Mf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lfx", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"lfy", "-", "ls", "+", "lt"}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"x2", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["x1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}], ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.807029332463945*^9, 3.807029415309591*^9, {3.8070294760448003`*^9, 
   3.80702951317137*^9}, 3.807029641335134*^9, {3.8070297034241495`*^9, 
   3.8070297441584826`*^9}, {3.807029785109995*^9, 3.8070298136078773`*^9}, 
   3.807030852392045*^9, 3.8070309312537723`*^9, 3.807031004398538*^9, 
   3.8070316054577217`*^9, {3.8070318074618855`*^9, 3.807031845189743*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Center of Mass", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.763816653783472*^9}, {3.7668481265350714`*^9, 
   3.7668481477981267`*^9}, {3.7668506621499777`*^9, 3.7668506628399115`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Mtotal", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{"Ms", "+", "Mf"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COM", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"expFoot", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "*", "Mf"}], 
       "+", 
       RowBox[{
        RowBox[{"expShank", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "*", "Ms"}]}], 
      ")"}], "/", "Mtotal"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ddCOM", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"COM", ",", "t"}], "]"}], ",", "t"}], "]"}]}], ";"}], " ", "//",
   "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.7668486252840843`*^9, 3.7668486490930033`*^9}, {
   3.766848680163347*^9, 3.7668487722907896`*^9}, {3.7668489204997654`*^9, 
   3.766848972164424*^9}, {3.766849327582846*^9, 3.766849486239126*^9}, {
   3.766849539920843*^9, 3.7668496591355314`*^9}, {3.766849691133127*^9, 
   3.766849794955684*^9}, {3.766849838815553*^9, 3.7668498753572845`*^9}, 
   3.7668502773152695`*^9, {3.766850657609066*^9, 3.7668506580725536`*^9}, 
   3.7668520771706724`*^9, {3.76685459667849*^9, 3.766854599331273*^9}, 
   3.7779017633905935`*^9, {3.777907845530485*^9, 3.7779078628370676`*^9}, {
   3.777908852388829*^9, 3.777908866271268*^9}, 3.7779089377113104`*^9, {
   3.777917034759614*^9, 3.777917152641156*^9}, {3.7779178760288005`*^9, 
   3.7779178798068*^9}, {3.7794515446123724`*^9, 3.7794515655932045`*^9}, {
   3.788894376176169*^9, 3.7888944049120646`*^9}, {3.789132232346242*^9, 
   3.789132242051746*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gravity", "Subsubsection",
 CellChangeTimes->{{3.7639204805204716`*^9, 3.763920481544552*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PE", " ", "=", 
   RowBox[{
    RowBox[{"g", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"expFoot", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}], "*", "Mf"}], "+", 
       RowBox[{
        RowBox[{"expShank", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}], "*", "Ms"}]}], ")"}]}], "//",
     "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Nvect", " ", "=", " ", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"D", "[", 
      RowBox[{"PE", ",", 
       RowBox[{"Transpose", "[", "x", "]"}]}], "]"}], "}"}], "]"}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.436353983078125*^9, 3.436353991234375*^9}, {
   3.436354181125*^9, 3.43635418390625*^9}, 3.5090404416343727`*^9, {
   3.509539414111295*^9, 3.509539527743894*^9}, 3.509539567648764*^9, {
   3.5095401253128805`*^9, 3.5095401303828897`*^9}, {3.5095401706491876`*^9, 
   3.5095401776848*^9}, {3.520767514421875*^9, 3.520767516734375*^9}, {
   3.520767582609375*^9, 3.520767645375*^9}, {3.5207676989375*^9, 
   3.520767715578125*^9}, {3.5230288115*^9, 3.52302884490625*^9}, {
   3.5431472111331916`*^9, 3.5431472276271915`*^9}, {3.5551550672540536`*^9, 
   3.5551550847125444`*^9}, {3.7354013090469794`*^9, 3.7354013272384634`*^9}, 
   3.735402586068088*^9, {3.7355700991070976`*^9, 3.735570100188266*^9}, 
   3.7366221128014383`*^9, {3.7366221436572127`*^9, 3.736622156672744*^9}, {
   3.736694910091427*^9, 3.736694926553073*^9}, {3.7366949728562174`*^9, 
   3.7366949909853835`*^9}, {3.7366951181023893`*^9, 3.736695130005561*^9}, {
   3.740489951746674*^9, 3.7404899555238447`*^9}, 3.74050757733245*^9, {
   3.740998914667108*^9, 3.740998917544409*^9}, {3.740999028057352*^9, 
   3.74099905490458*^9}, {3.7409994625500927`*^9, 3.740999476116825*^9}, {
   3.763816821368079*^9, 3.763816827176324*^9}, {3.7639205215778227`*^9, 
   3.763920532347257*^9}, 3.7639209083266277`*^9, 3.7779166796306763`*^9, 
   3.777916742155121*^9, 3.7779176376733427`*^9, {3.7779177285125875`*^9, 
   3.7779178476035852`*^9}, {3.777917914277705*^9, 3.7779179330661697`*^9}, {
   3.7779179800614843`*^9, 3.7779179983762894`*^9}, 3.7794516778126163`*^9, {
   3.77945180036242*^9, 3.7794518014721785`*^9}, {3.7888944203840327`*^9, 
   3.788894420736061*^9}, {3.78913223235925*^9, 3.789132242063746*^9}, {
   3.7894057360660276`*^9, 3.7894057465460215`*^9}, {3.807027142889626*^9, 
   3.807027153423782*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"g", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"lfx", " ", "Mf", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x1", "[", "t", "]"}], "+", 
          RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"ls", " ", "Mf"}], "+", 
          FractionBox[
           RowBox[{"lt", " ", "Ms"}], "2"]}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"lfy", "-", "ls", "+", "lt"}], ")"}], " ", "Mf", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x1", "[", "t", "]"}], "+", 
          RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"g", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"lfx", " ", "Mf", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x1", "[", "t", "]"}], "+", 
          RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"lfy", "-", "ls", "+", "lt"}], ")"}], " ", "Mf", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x1", "[", "t", "]"}], "+", 
          RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.779451683282484*^9, 3.779451744026821*^9, 3.779451832725129*^9, 
   3.7794521369373393`*^9, 3.7794548923139486`*^9, 3.7794549371520424`*^9, 
   3.779454975246415*^9, 3.7794550460155144`*^9, 3.7794558857633057`*^9, 
   3.779456051646635*^9, 3.7888947700579147`*^9, 3.7888948462025585`*^9, 
   3.7888949255079546`*^9, 3.788895181782296*^9, 3.788895419158617*^9, 
   3.7891324523806696`*^9, 3.789133130635973*^9, 3.789135624139043*^9, 
   3.7891430540289087`*^9, 3.78931971099518*^9, 3.7894059118847833`*^9, 
   3.789406013334484*^9, 3.7894062170754604`*^9, 3.789406291769814*^9, 
   3.7894063233256207`*^9, 3.789406477008486*^9, 3.789489154553608*^9, 
   3.7894892866145873`*^9, 3.789489409822437*^9, {3.807027497765291*^9, 
   3.8070275740757065`*^9}, 3.80702933422291*^9, 3.807029416987631*^9, {
   3.807029477758793*^9, 3.807029514834369*^9}, 3.807029643010126*^9, {
   3.8070297051111355`*^9, 3.8070297458324776`*^9}, {3.8070297867683034`*^9, 
   3.807029815282879*^9}, 3.8070308542350645`*^9, 3.8070309329919186`*^9, 
   3.807031006161273*^9, 3.8070316071677256`*^9, {3.8070318077769165`*^9, 
   3.8070318469147787`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"g", "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"expFoot", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "4"}], "]"}], "]"}], "*", "Mf"}], ")"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.789137226331215*^9, 3.789137230716157*^9}, {
  3.78913726972679*^9, 3.7891372721437674`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"g", " ", "Mf", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "ls"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"x1", "[", "t", "]"}], "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"lfy", "-", "ls", "+", "lt"}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], "+", 
        RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
     RowBox[{"lfx", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], "+", 
        RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7891372380311337`*^9, 3.7891372762137547`*^9, 3.7891430540469084`*^9, 
   3.789319711013678*^9, 3.789405911924865*^9, 3.789406013369561*^9, 
   3.789406217115462*^9, 3.789406291816799*^9, 3.7894063233586216`*^9, 
   3.7894064770564537`*^9, 3.7894891546116114`*^9, 3.7894892866765566`*^9, 
   3.789489409866459*^9, {3.807027497793292*^9, 3.807027574100707*^9}, 
   3.807029334269907*^9, 3.807029417009659*^9, {3.8070294777807946`*^9, 
   3.807029514858368*^9}, 3.807029643031126*^9, {3.8070297051351366`*^9, 
   3.8070297458565063`*^9}, {3.8070297867923336`*^9, 3.8070298153048763`*^9}, 
   3.8070308542600365`*^9, 3.8070309330159197`*^9, 3.807031006186243*^9, 
   3.8070316071986957`*^9, {3.8070318078679433`*^9, 3.8070318469387455`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["DSLIP Embedding", "Subsubsection",
 CellChangeTimes->{{3.7639204805204716`*^9, 3.763920481544552*^9}, {
  3.7639209191915884`*^9, 3.7639209220715466`*^9}, {3.7639224290917854`*^9, 
  3.763922465550254*^9}, {3.766847648630418*^9, 3.7668476514948564`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pH", " ", "=", 
  RowBox[{"RPToHomogeneous", "[", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "lt", ",", "0"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pCOP", "=", 
  RowBox[{
   RowBox[{"e1", ".", "e2", ".", 
    RowBox[{"RPToHomogeneous", "[", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"COPfx", ",", 
        RowBox[{
         RowBox[{"-", "ls"}], "-", "la"}], ",", "0"}], "}"}]}], "]"}]}], "//",
    "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.766845505688058*^9, 3.76684553289999*^9}, {
   3.7668455649474115`*^9, 3.7668455969328227`*^9}, {3.7668456976205077`*^9, 
   3.7668457176855545`*^9}, {3.7668458100990033`*^9, 
   3.7668459042453127`*^9}, {3.766845977154875*^9, 3.7668459781451063`*^9}, {
   3.7668460926259336`*^9, 3.7668461072798533`*^9}, {3.766846150273282*^9, 
   3.7668461957155275`*^9}, {3.7668462660170736`*^9, 
   3.7668462688002214`*^9}, {3.7668476363281727`*^9, 3.766847637430479*^9}, 
   3.7668509562465286`*^9, 3.7669255101716204`*^9, {3.766933693325363*^9, 
   3.7669336959598923`*^9}, 3.7779176157591467`*^9, 3.777917647904228*^9, {
   3.7779180828433976`*^9, 3.7779180836784663`*^9}, {3.7779181149456663`*^9, 
   3.7779181240526733`*^9}, {3.77945150433457*^9, 3.7794515108626733`*^9}, {
   3.7888944733923793`*^9, 3.7888944942580204`*^9}, {3.7888948126948204`*^9, 
   3.788894825807789*^9}, {3.7888949042241383`*^9, 3.788894905759107*^9}, {
   3.788894999153144*^9, 3.7888950356723747`*^9}, {3.788895104864175*^9, 
   3.7888951152471733`*^9}, {3.788895241135119*^9, 3.7888952527861176`*^9}, 
   3.7888953409104223`*^9, {3.7894057568656845`*^9, 3.7894058101160607`*^9}, {
   3.807027165818469*^9, 3.807027233193213*^9}, {3.8070272719703875`*^9, 
   3.8070272721233835`*^9}, {3.8070275644066334`*^9, 3.807027564694662*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "lt"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7888954191766376`*^9, 3.789132452435636*^9, 3.7891331306849847`*^9, 
   3.7891356241570415`*^9, 3.7891430540649104`*^9, 3.789319711027666*^9, 
   3.789405911945691*^9, 3.7894060133848095`*^9, 3.78940621713546*^9, 
   3.789406291833784*^9, 3.7894063233746195`*^9, 3.7894064770744843`*^9, 
   3.789489154632606*^9, 3.7894892866925573`*^9, 3.7894894098824396`*^9, {
   3.8070274978182883`*^9, 3.8070275741247067`*^9}, 3.80702933433891*^9, 
   3.807029417031633*^9, {3.807029477805795*^9, 3.807029514882368*^9}, 
   3.807029643052126*^9, {3.8070297051581373`*^9, 3.807029745880503*^9}, {
   3.8070297868143024`*^9, 3.8070298153268805`*^9}, 3.8070308542860365`*^9, 
   3.8070309330409203`*^9, 3.807031006211239*^9, 3.8070316072457*^9, {
   3.807031807941946*^9, 3.8070318469627457`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"x1", "[", "t", "]"}], "+", 
       RowBox[{"x2", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], "+", 
        RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], ",", "0", ",", 
     RowBox[{
      RowBox[{"COPfx", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x1", "[", "t", "]"}], "+", 
         RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"ls", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"la", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x1", "[", "t", "]"}], "+", 
         RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"x1", "[", "t", "]"}], "+", 
       RowBox[{"x2", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"x1", "[", "t", "]"}], "+", 
       RowBox[{"x2", "[", "t", "]"}]}], "]"}], ",", "0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "ls"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"x1", "[", "t", "]"}], "]"}]}], "-", 
      RowBox[{"la", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x1", "[", "t", "]"}], "+", 
         RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"COPfx", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x1", "[", "t", "]"}], "+", 
         RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7888954191766376`*^9, 3.789132452435636*^9, 3.7891331306849847`*^9, 
   3.7891356241570415`*^9, 3.7891430540649104`*^9, 3.789319711027666*^9, 
   3.789405911945691*^9, 3.7894060133848095`*^9, 3.78940621713546*^9, 
   3.789406291833784*^9, 3.7894063233746195`*^9, 3.7894064770744843`*^9, 
   3.789489154632606*^9, 3.7894892866925573`*^9, 3.7894894098824396`*^9, {
   3.8070274978182883`*^9, 3.8070275741247067`*^9}, 3.80702933433891*^9, 
   3.807029417031633*^9, {3.807029477805795*^9, 3.807029514882368*^9}, 
   3.807029643052126*^9, {3.8070297051581373`*^9, 3.807029745880503*^9}, {
   3.8070297868143024`*^9, 3.8070298153268805`*^9}, 3.8070308542860365`*^9, 
   3.8070309330409203`*^9, 3.807031006211239*^9, 3.8070316072457*^9, {
   3.807031807941946*^9, 3.8070318470457783`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"L1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Refine", "[", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pH", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "-", 
         RowBox[{"pCOP", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], " ", ",", 
        "2"}], "]"}], ",", 
      RowBox[{"x", " ", "\[Element]", "Reals"}]}], "]"}], " ", "//", 
    "FullSimplify"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"L1dot", " ", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"L1", ",", "t"}], "]"}], "//", "FullSimplify"}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.766845505688058*^9, 3.76684553289999*^9}, {
   3.7668455649474115`*^9, 3.7668455969328227`*^9}, {3.7668456976205077`*^9, 
   3.7668457176855545`*^9}, {3.7668458100990033`*^9, 
   3.7668459042453127`*^9}, {3.766845977154875*^9, 3.7668459781451063`*^9}, {
   3.7668460926259336`*^9, 3.7668461072798533`*^9}, {3.766846150273282*^9, 
   3.7668461957155275`*^9}, {3.7668462660170736`*^9, 
   3.7668462688002214`*^9}, {3.7668476363281727`*^9, 3.766847637430479*^9}, 
   3.7668509562465286`*^9, 3.7669255101716204`*^9, {3.766933693325363*^9, 
   3.7669336959598923`*^9}, 3.7779176157591467`*^9, 3.777917647904228*^9, {
   3.7779180828433976`*^9, 3.7779180836784663`*^9}, {3.7779181149456663`*^9, 
   3.7779181240526733`*^9}, {3.77945150433457*^9, 3.7794515108626733`*^9}, {
   3.7888944733923793`*^9, 3.7888944942580204`*^9}, {3.7888948126948204`*^9, 
   3.788894825807789*^9}, {3.7888949042241383`*^9, 3.788894905759107*^9}, {
   3.788894999153144*^9, 3.7888950356723747`*^9}, {3.788895104864175*^9, 
   3.7888951152471733`*^9}, {3.788895241135119*^9, 3.7888952527861176`*^9}, {
   3.788895334610432*^9, 3.7888953712973776`*^9}, {3.7893196565027037`*^9, 
   3.7893196813826714`*^9}, 3.8070275448364797`*^9, 3.807029270654355*^9}],

Cell[BoxData[
 TagBox[
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"lt", "+", 
       RowBox[{"ls", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"la", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x1", "[", "t", "]"}], "+", 
          RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"COPfx", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x1", "[", "t", "]"}], "+", 
          RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"COPfx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x1", "[", "t", "]"}], "+", 
          RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"ls", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"la", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x1", "[", "t", "]"}], "+", 
          RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"]}]],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8070293350009074`*^9, 3.8070294177856307`*^9, {3.8070294785498695`*^9, 
   3.8070295155878773`*^9}, 3.8070296437951193`*^9, {3.807029705887165*^9, 
   3.8070297466054764`*^9}, {3.8070297875313025`*^9, 3.8070298160499487`*^9}, 
   3.807030855021035*^9, 3.8070309337459507`*^9, 3.807031006958265*^9, 
   3.8070316079967318`*^9, {3.807031808033947*^9, 3.807031847707773*^9}}],

Cell[BoxData[
 TagBox[
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "lt"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"COPfx", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x1", "[", "t", "]"}], "+", 
          RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"ls", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"la", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x1", "[", "t", "]"}], "+", 
          RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["x1", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"COPfx", " ", "ls", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"COPfx", " ", "lt", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x1", "[", "t", "]"}], "+", 
          RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"la", " ", "ls", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"la", " ", "lt", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x1", "[", "t", "]"}], "+", 
          RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["x2", "\[Prime]",
       MultilineFunction->None], "[", "t", "]"}]}]}], 
   SqrtBox[
    RowBox[{
     SuperscriptBox["COPfx", "2"], "+", 
     SuperscriptBox["la", "2"], "+", 
     SuperscriptBox["ls", "2"], "+", 
     SuperscriptBox["lt", "2"], "+", 
     RowBox[{"2", " ", "ls", " ", "lt", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
     RowBox[{"2", " ", "la", " ", "ls", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
     RowBox[{"2", " ", "la", " ", "lt", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], "+", 
        RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "-", 
     RowBox[{"2", " ", "COPfx", " ", "ls", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"x2", "[", "t", "]"}], "]"}]}], "-", 
     RowBox[{"2", " ", "COPfx", " ", "lt", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"x1", "[", "t", "]"}], "+", 
        RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}]]],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8070293350009074`*^9, 3.8070294177856307`*^9, {3.8070294785498695`*^9, 
   3.8070295155878773`*^9}, 3.8070296437951193`*^9, {3.807029705887165*^9, 
   3.8070297466054764`*^9}, {3.8070297875313025`*^9, 3.8070298160499487`*^9}, 
   3.807030855021035*^9, 3.8070309337459507`*^9, 3.807031006958265*^9, 
   3.8070316079967318`*^9, {3.807031808033947*^9, 3.8070318485917683`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"LJacob1", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"D", "[", 
      RowBox[{"L1", ",", 
       RowBox[{"Transpose", "[", "x", "]"}]}], "]"}], "}"}], "//", 
    "FullSimplify"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.807029278957737*^9, 3.807029311563914*^9}, {
   3.8070293629093127`*^9, 3.807029384709399*^9}, {3.8070294310211735`*^9, 
   3.8070294939917974`*^9}, 3.807029599885118*^9, {3.8070317968810663`*^9, 
   3.807031802272623*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"lt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"COPfx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"ls", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"la", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["COPfx", "2"], "+", 
          SuperscriptBox["la", "2"], "+", 
          SuperscriptBox["ls", "2"], "+", 
          SuperscriptBox["lt", "2"], "+", 
          RowBox[{"2", " ", "ls", " ", "lt", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"2", " ", "la", " ", "ls", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"2", " ", "la", " ", "lt", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"x1", "[", "t", "]"}], "+", 
             RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"2", " ", "COPfx", " ", "ls", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"x2", "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{"2", " ", "COPfx", " ", "lt", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"x1", "[", "t", "]"}], "+", 
             RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}]]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"COPfx", " ", "ls", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"COPfx", " ", "lt", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x1", "[", "t", "]"}], "+", 
            RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"la", " ", "ls", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"la", " ", "lt", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x1", "[", "t", "]"}], "+", 
            RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox["COPfx", "2"], "+", 
          SuperscriptBox["la", "2"], "+", 
          SuperscriptBox["ls", "2"], "+", 
          SuperscriptBox["lt", "2"], "+", 
          RowBox[{"2", " ", "ls", " ", "lt", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"2", " ", "la", " ", "ls", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"2", " ", "la", " ", "lt", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"x1", "[", "t", "]"}], "+", 
             RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"2", " ", "COPfx", " ", "ls", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"x2", "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{"2", " ", "COPfx", " ", "lt", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"x1", "[", "t", "]"}], "+", 
             RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}]]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8070294187376213`*^9, {3.807029479587302*^9, 3.8070295171363573`*^9}, 
   3.8070296453386836`*^9, {3.807029707444126*^9, 3.8070297481494665`*^9}, {
   3.8070297890693645`*^9, 3.8070298176259775`*^9}, 3.807030856639041*^9, 
   3.807030935272107*^9, 3.80703100853823*^9, 3.807031609644843*^9, {
   3.807031808180942*^9, 3.8070318492767396`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"LHess", "=", "  ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"Flatten", "[", "LJacob1", "]"}], ",", 
      RowBox[{"Transpose", "[", "x", "]"}]}], "]"}], "//", "FullSimplify"}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.8070293904462996`*^9, 3.8070294029529467`*^9}, {
  3.807029605829807*^9, 3.8070296259346957`*^9}, {3.8070296884073267`*^9, 
  3.8070297181412535`*^9}, {3.807029763497542*^9, 3.807029802314228*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{"lt", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "lt", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"COPfx", " ", 
               RowBox[{"Cos", "[", 
                RowBox[{
                 RowBox[{"x1", "[", "t", "]"}], "+", 
                 RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
              RowBox[{"ls", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
              RowBox[{"la", " ", 
               RowBox[{"Sin", "[", 
                RowBox[{
                 RowBox[{"x1", "[", "t", "]"}], "+", 
                 RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"]}], 
          "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"ls", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"la", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"x1", "[", "t", "]"}], "+", 
                RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "-", 
             RowBox[{"COPfx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"x1", "[", "t", "]"}], "+", 
                RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["COPfx", "2"], "+", 
             SuperscriptBox["la", "2"], "+", 
             SuperscriptBox["ls", "2"], "+", 
             SuperscriptBox["lt", "2"], "+", 
             RowBox[{"2", " ", "ls", " ", "lt", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"2", " ", "la", " ", "ls", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"2", " ", "la", " ", "lt", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"x1", "[", "t", "]"}], "+", 
                RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "-", 
             RowBox[{"2", " ", "COPfx", " ", "ls", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x2", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"2", " ", "COPfx", " ", "lt", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"x1", "[", "t", "]"}], "+", 
                RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["COPfx", "2"], "+", 
           SuperscriptBox["la", "2"], "+", 
           SuperscriptBox["ls", "2"], "+", 
           SuperscriptBox["lt", "2"], "+", 
           RowBox[{"2", " ", "ls", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "la", " ", "ls", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "la", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"2", " ", "COPfx", " ", "ls", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"2", " ", "COPfx", " ", "lt", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]]}]], 
      FractionBox[
       RowBox[{"lt", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "la"}], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"x1", "[", "t", "]"}], "+", 
                RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
             RowBox[{"COPfx", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"x1", "[", "t", "]"}], "+", 
                RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["COPfx", "2"], "+", 
             SuperscriptBox["la", "2"], "+", 
             SuperscriptBox["ls", "2"], "+", 
             SuperscriptBox["lt", "2"], "+", 
             RowBox[{"2", " ", "ls", " ", "lt", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"2", " ", "la", " ", "ls", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"2", " ", "la", " ", "lt", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"x1", "[", "t", "]"}], "+", 
                RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "-", 
             RowBox[{"2", " ", "COPfx", " ", "ls", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x2", "[", "t", "]"}], "]"}]}], "-", 
             RowBox[{"2", " ", "COPfx", " ", "lt", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"x1", "[", "t", "]"}], "+", 
                RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"COPfx", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"x1", "[", "t", "]"}], "+", 
                RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
             RowBox[{"ls", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"la", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"x1", "[", "t", "]"}], "+", 
                RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"COPfx", " ", "ls", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"COPfx", " ", "lt", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"x1", "[", "t", "]"}], "+", 
                RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
             RowBox[{"la", " ", "ls", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"la", " ", "lt", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"x1", "[", "t", "]"}], "+", 
                RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], 
         ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["COPfx", "2"], "+", 
           SuperscriptBox["la", "2"], "+", 
           SuperscriptBox["ls", "2"], "+", 
           SuperscriptBox["lt", "2"], "+", 
           RowBox[{"2", " ", "ls", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "la", " ", "ls", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "la", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"2", " ", "COPfx", " ", "ls", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"2", " ", "COPfx", " ", "lt", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]]}]]},
     {
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "lt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "la"}], " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"COPfx", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["COPfx", "2"], "+", 
           SuperscriptBox["la", "2"], "+", 
           SuperscriptBox["ls", "2"], "+", 
           SuperscriptBox["lt", "2"], "+", 
           RowBox[{"2", " ", "ls", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "la", " ", "ls", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "la", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"2", " ", "COPfx", " ", "ls", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"2", " ", "COPfx", " ", "lt", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", "lt", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"COPfx", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"ls", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"la", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"COPfx", " ", "ls", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"COPfx", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"la", " ", "ls", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"la", " ", "lt", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["COPfx", "2"], "+", 
           SuperscriptBox["la", "2"], "+", 
           SuperscriptBox["ls", "2"], "+", 
           SuperscriptBox["lt", "2"], "+", 
           RowBox[{"2", " ", "ls", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "la", " ", "ls", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "la", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"2", " ", "COPfx", " ", "ls", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"2", " ", "COPfx", " ", "lt", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["COPfx", "2"], "+", 
           SuperscriptBox["la", "2"], "+", 
           SuperscriptBox["ls", "2"], "+", 
           SuperscriptBox["lt", "2"], "+", 
           RowBox[{"2", " ", "ls", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "la", " ", "ls", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "la", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"2", " ", "COPfx", " ", "ls", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"2", " ", "COPfx", " ", "lt", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "la"}], " ", "ls", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"la", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
           RowBox[{"COPfx", " ", "ls", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"COPfx", " ", "lt", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"COPfx", " ", "ls", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"COPfx", " ", "lt", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x1", "[", "t", "]"}], "+", 
               RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "+", 
            RowBox[{"la", " ", "ls", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"la", " ", "lt", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x1", "[", "t", "]"}], "+", 
               RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"]}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["COPfx", "2"], "+", 
           SuperscriptBox["la", "2"], "+", 
           SuperscriptBox["ls", "2"], "+", 
           SuperscriptBox["lt", "2"], "+", 
           RowBox[{"2", " ", "ls", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x1", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "la", " ", "ls", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"2", " ", "la", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "-", 
           RowBox[{"2", " ", "COPfx", " ", "ls", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x2", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"2", " ", "COPfx", " ", "lt", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"x1", "[", "t", "]"}], "+", 
              RowBox[{"x2", "[", "t", "]"}]}], "]"}]}]}], ")"}], 
         RowBox[{"3", "/", "2"}]]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.807029303544027*^9, 3.807029335964898*^9}, 
   3.8070294211516123`*^9, {3.8070294796232986`*^9, 3.807029499411867*^9}, 
   3.807029534546343*^9, 3.807029662761159*^9, {3.807029707550131*^9, 
   3.807029748214466*^9}, 3.8070297891673636`*^9, 3.807029835085066*^9, 
   3.8070308756700535`*^9, 3.807030953662017*^9, 3.8070310270756645`*^9, 
   3.8070316292197084`*^9, 3.807031808346943*^9, 3.807031867943528*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"ML", " ", "=", " ", 
   RowBox[{
    RowBox[{"PseudoInverse", "[", 
     RowBox[{"LJacob1", ".", 
      RowBox[{"Inverse", "[", "Mmatrix", "]"}]}], "]"}], "//", 
    "FullSimplify"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.766845505688058*^9, 3.76684553289999*^9}, {
   3.7668455649474115`*^9, 3.7668455969328227`*^9}, {3.7668456976205077`*^9, 
   3.7668457176855545`*^9}, {3.7668458100990033`*^9, 
   3.7668459042453127`*^9}, {3.766845977154875*^9, 3.7668459781451063`*^9}, {
   3.7668460926259336`*^9, 3.7668461072798533`*^9}, {3.766846150273282*^9, 
   3.7668461957155275`*^9}, {3.7668462660170736`*^9, 
   3.7668462688002214`*^9}, {3.7668476363281727`*^9, 3.766847637430479*^9}, 
   3.7668509562465286`*^9, 3.7669255101716204`*^9, {3.766933693325363*^9, 
   3.7669336959598923`*^9}, 3.7779176157591467`*^9, 3.777917647904228*^9, {
   3.7779180828433976`*^9, 3.7779180836784663`*^9}, {3.7779181149456663`*^9, 
   3.7779181240526733`*^9}, {3.77945150433457*^9, 3.7794515108626733`*^9}, {
   3.7888944733923793`*^9, 3.7888944942580204`*^9}, {3.7888948126948204`*^9, 
   3.788894825807789*^9}, {3.7888949042241383`*^9, 3.788894905759107*^9}, {
   3.788894999153144*^9, 3.7888950356723747`*^9}, {3.788895104864175*^9, 
   3.7888951152471733`*^9}, {3.788895241135119*^9, 3.7888952527861176`*^9}, {
   3.788895334610432*^9, 3.7888953712973776`*^9}, {3.7893196565027037`*^9, 
   3.7893196813826714`*^9}, 3.8070275448364797`*^9, 3.807029270654355*^9, 
   3.8070295981974683`*^9, {3.807031345079073*^9, 3.8070314259111705`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"$RecursionLimit", "::", "reclim2"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Recursion depth of \
\[NoBreak]\\!\\(\\*RowBox[{\\\"1024\\\"}]\\)\[NoBreak] exceeded during \
evaluation of \[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"x\\\", \
\\\"[\\\", \\\"1\\\", \\\"]\\\"}], \\\"}\\\"}]\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/$RecursionLimit\\\", ButtonNote \
-> \\\"$RecursionLimit::reclim2\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.807031629432708*^9, 3.8070318084219127`*^9}],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  TagBox[
   RowBox[{"ML", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"PseudoInverse", "[", 
      RowBox[{"LJacob1", ".", 
       RowBox[{"Inverse", "[", "Mmatrix", "]"}]}], "]"}], "]"}]}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], "]"}]], "Output",
 CellChangeTimes->{3.807031635549772*^9, 3.8070318084249125`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"BLinv", " ", "=", " ", 
   RowBox[{
    RowBox[{"PseudoInverse", "[", 
     RowBox[{"ML", ".", "LJacob1", ".", 
      RowBox[{"Inverse", "[", "Mmatrix", "]"}]}], "]"}], "//", 
    "FullSimplify"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.807031527295699*^9, 3.807031538935384*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"$RecursionLimit", "::", "reclim2"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Recursion depth of \
\[NoBreak]\\!\\(\\*RowBox[{\\\"1024\\\"}]\\)\[NoBreak] exceeded during \
evaluation of \[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{\\\"x\\\", \
\\\"[\\\", \\\"1\\\", \\\"]\\\"}], \\\"}\\\"}]\\)\[NoBreak]. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/$RecursionLimit\\\", ButtonNote \
-> \\\"$RecursionLimit::reclim2\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.8070316357977457`*^9, 3.8070318084999413`*^9}],

Cell[BoxData[
 RowBox[{"Hold", "[", 
  TagBox[
   RowBox[{"BLinv", "=", 
    RowBox[{"FullSimplify", "[", 
     RowBox[{"PseudoInverse", "[", 
      RowBox[{"ML", ".", "LJacob1", ".", 
       RowBox[{"Inverse", "[", "Mmatrix", "]"}]}], "]"}], "]"}]}],
   Function[BoxForm`e$, 
    MatrixForm[BoxForm`e$]]], "]"}]], "Output",
 CellChangeTimes->{3.8070316369732523`*^9, 3.80703180850391*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Output", "Section",
 CellChangeTimes->{{3.511177531124222*^9, 3.511177531860264*^9}, 
   3.807027478167445*^9, {3.8070276062458076`*^9, 3.8070276236078143`*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "x", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dim", "=", "2"}], ";"}]}], "Input",
 CellChangeTimes->{{3.807027733756583*^9, 3.80702773397458*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"x1", "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "1", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"x2", "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "2", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x1", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", 
      RowBox[{"dim", "+", "1"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x2", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", 
      RowBox[{"dim", "+", "2"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x3", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", 
      RowBox[{"dim", "+", "3"}], "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x4", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", 
      RowBox[{"dim", "+", "4"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x1", "''"}], "[", "t", "]"}], ":=", 
     RowBox[{"ac", "[", "1", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x2", "''"}], "[", "t", "]"}], ":=", 
     RowBox[{"ac", "[", "2", "]"}]}]}], "}"}], ";"}]], "Input",
 CellChangeTimes->{{3.807027751848432*^9, 3.807027759334337*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{"Mmatrix", ",", "M"}], "]"}]], "Input",
 CellChangeTimes->{{3.8070278358106666`*^9, 3.807027862652293*^9}}],

Cell[BoxData["\<\"M=[(1/4).*lt.^2.*Ms+Mf.*(lfy+(-1).*ls+lt+ls.*cos(x(2))).^2+\
Mf.*(lfx+(-1).*ls.*sin(x(2))).^2,(lfy+(-1).*ls+lt).*Mf.*(lfy+(-1).*ls+lt+ls.*\
cos(x(2)))+lfx.*Mf.*(lfx+(-1).*ls.*sin(x(2)));(lfy+(-1).*ls+lt).*Mf.*(lfy+(-1)\
.*ls+lt+ls.*cos(x(2)))+lfx.*Mf.*(lfx+(-1).*ls.*sin(x(2))),lfx.^2.*Mf+(lfy+(-1)\
.*ls+lt).^2.*Mf];\\n\"\>"], "Output",
 CellChangeTimes->{{3.807027884304437*^9, 3.8070279044983697`*^9}, 
   3.80702798960245*^9, 3.8070293367009315`*^9, 3.8070294219816217`*^9, {
   3.807029480315308*^9, 3.8070294995708504`*^9}, 3.8070295348713408`*^9, 
   3.807029662897216*^9, {3.807029707653125*^9, 3.8070297483204856`*^9}, 
   3.8070297892713633`*^9, 3.807029835207967*^9, 3.807030875804055*^9, 
   3.807030953799016*^9, 3.8070310272706366`*^9, 3.807031637090252*^9, 
   3.80703180854994*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ToMatlab", "[", 
   RowBox[{"Cmtx", ",", "C"}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.807027874196384*^9, 3.807027916365594*^9}}],

Cell[BoxData["\<\"C=[ls.*Mf.*((-1).*lfx.*cos(x(2))+(-1).*(lfy+(-1).*ls+lt).*\
sin(x(2))).*x(4),ls.*Mf.*((-1).*lfx.*cos(x(2))+(-1).*(lfy+(-1).*ls+lt).*sin(x(\
2))).*(x(3)+x(4));ls.*Mf.*(lfx.*cos(x(2))+(lfy+(-1).*ls+lt).*sin(x(2))).*x(3),\
0];\\n\"\>"], "Output",
 CellChangeTimes->{{3.807027884325436*^9, 3.80702790452137*^9}, 
   3.8070279896234493`*^9, 3.807029336721898*^9, 3.8070294220026236`*^9, {
   3.8070294803363285`*^9, 3.80702949959188*^9}, 3.8070295348943405`*^9, 
   3.807029662917218*^9, {3.807029707673154*^9, 3.807029748341465*^9}, 
   3.807029789292367*^9, 3.807029835229941*^9, 3.8070308758260283`*^9, 
   3.8070309538230443`*^9, 3.807031027295678*^9, 3.8070316371122804`*^9, 
   3.80703180858294*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ToMatlab", "[", 
   RowBox[{"Nvect", ",", "G"}], "]"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.8070279203410935`*^9, 3.80702793439777*^9}}],

Cell[BoxData["\<\"G=[g.*(lfx.*Mf.*cos(x(1)+x(2))+(ls.*Mf+(1/2).*lt.*Ms).*sin(\
x(1))+(lfy+(-1).*ls+lt).*Mf.*sin(x(1)+x(2)));g.*(lfx.*Mf.*cos(x(1)+x(2))+(lfy+\
(-1).*ls+lt).*Mf.*sin(x(1)+x(2)))];\\n\"\>"], "Output",
 CellChangeTimes->{
  3.807027989646449*^9, 3.807029336742898*^9, 3.8070294220276504`*^9, {
   3.807029480357309*^9, 3.8070294996118507`*^9}, 3.8070295349153433`*^9, 
   3.807029662938218*^9, {3.807029707694125*^9, 3.8070297483614907`*^9}, 
   3.8070297893153934`*^9, 3.807029835251937*^9, 3.807030875849029*^9, 
   3.8070309538460484`*^9, 3.8070310273197026`*^9, 3.8070316371362624`*^9, 
   3.807031808607919*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{"L1", ",", "L"}], "]"}]], "Input",
 CellChangeTimes->{{3.807027965646555*^9, 3.8070279675741234`*^9}}],

Cell[BoxData["\<\"L=((lt+ls.*cos(x(1))+la.*cos(x(1)+x(2))+(-1).*COPfx.*sin(x(\
1)+x(2))).^2+(COPfx.*cos(x(1)+x(2))+ls.*sin(x(1))+la.*sin(x(1)+x(2))).^2).^(1/\
2);\\n\"\>"], "Output",
 CellChangeTimes->{
  3.807027989669449*^9, 3.807029336763898*^9, 3.807029422055626*^9, {
   3.807029480377306*^9, 3.8070294996318507`*^9}, 3.8070295349363704`*^9, 
   3.8070296629602137`*^9, {3.8070297077151275`*^9, 3.807029748382464*^9}, 
   3.8070297893373632`*^9, 3.8070298352749405`*^9, 3.8070308758730335`*^9, 
   3.8070309538690157`*^9, 3.8070310273437033`*^9, 3.8070316371572514`*^9, 
   3.8070318086749105`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{"LJacob1", ",", "JL"}], "]"}]], "Input",
 CellChangeTimes->{{3.807027972596366*^9, 3.8070280122862396`*^9}, 
   3.807029915487398*^9}],

Cell[BoxData["\<\"JL=[(-1).*lt.*(COPfx.*cos(x(1)+x(2))+ls.*sin(x(1))+la.*sin(\
x(1)+x(2))).*(COPfx.^2+la.^2+ls.^2+lt.^2+2.*ls.*lt.*cos(x(1))+2.*la.*ls.*cos(\
x(2))+2.*la.*lt.*cos(x(1)+x(2))+(-2).*COPfx.*ls.*sin(x(2))+(-2).*COPfx.*lt.*\
sin(x(1)+x(2))).^(-1/2);(-1).*(COPfx.^2+la.^2+ls.^2+lt.^2+2.*ls.*lt.*cos(x(1))\
+2.*la.*ls.*cos(x(2))+2.*la.*lt.*cos(x(1)+x(2))+(-2).*COPfx.*ls.*sin(x(2))+(-\
2).*COPfx.*lt.*sin(x(1)+x(2))).^(-1/2).*(COPfx.*ls.*cos(x(2))+COPfx.*lt.*cos(\
x(1)+x(2))+la.*ls.*sin(x(2))+la.*lt.*sin(x(1)+x(2)))];\\n\"\>"], "Output",
 CellChangeTimes->{
  3.807027989693449*^9, 3.8070293367888947`*^9, 3.807029422079649*^9, {
   3.807029480397306*^9, 3.8070294996538534`*^9}, 3.807029534959339*^9, 
   3.8070296629842186`*^9, {3.807029707735128*^9, 3.8070297484034643`*^9}, 
   3.8070297893583927`*^9, 3.807029835295967*^9, 3.807030875896027*^9, 
   3.8070309538920164`*^9, 3.8070310273676777`*^9, 3.80703163718128*^9, 
   3.8070318087219114`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{"LHess", ",", "HL"}], "]"}]], "Input",
 CellChangeTimes->{{3.8070299235527534`*^9, 3.807029937466013*^9}}],

Cell[BoxData["\<\"HL=[(1/2).*lt.*(COPfx.^2+la.^2+ls.^2+lt.^2+2.*ls.*lt.*cos(x(\
1))+2.*la.*ls.*cos(x(2))+2.*la.*lt.*cos(x(1)+x(2))+(-2).*COPfx.*ls.*sin(x(2))+\
(-2).*COPfx.*lt.*sin(x(1)+x(2))).^(-3/2).*((-2).*lt.*(COPfx.*cos(x(1)+x(2))+\
ls.*sin(x(1))+la.*sin(x(1)+x(2))).^2+(-2).*(ls.*cos(x(1))+la.*cos(x(1)+x(2))+(\
-1).*COPfx.*sin(x(1)+x(2))).*(COPfx.^2+la.^2+ls.^2+lt.^2+2.*ls.*lt.*cos(x(1))+\
2.*la.*ls.*cos(x(2))+2.*la.*lt.*cos(x(1)+x(2))+(-2).*COPfx.*ls.*sin(x(2))+(-2)\
.*COPfx.*lt.*sin(x(1)+x(2)))),(1/2).*lt.*(COPfx.^2+la.^2+ls.^2+lt.^2+2.*ls.*\
lt.*cos(x(1))+2.*la.*ls.*cos(x(2))+2.*la.*lt.*cos(x(1)+x(2))+(-2).*COPfx.*ls.*\
sin(x(2))+(-2).*COPfx.*lt.*sin(x(1)+x(2))).^(-3/2).*(2.*((-1).*la.*cos(x(1)+x(\
2))+COPfx.*sin(x(1)+x(2))).*(COPfx.^2+la.^2+ls.^2+lt.^2+2.*ls.*lt.*cos(x(1))+\
2.*la.*ls.*cos(x(2))+2.*la.*lt.*cos(x(1)+x(2))+(-2).*COPfx.*ls.*sin(x(2))+(-2)\
.*COPfx.*lt.*sin(x(1)+x(2)))+(-2).*(COPfx.*cos(x(1)+x(2))+ls.*sin(x(1))+la.*\
sin(x(1)+x(2))).*(COPfx.*ls.*cos(x(2))+COPfx.*lt.*cos(x(1)+x(2))+la.*ls.*sin(\
x(2))+la.*lt.*sin(x(1)+x(2))));(1/2).*(COPfx.^2+la.^2+ls.^2+lt.^2+2.*ls.*lt.*\
cos(x(1))+2.*la.*ls.*cos(x(2))+2.*la.*lt.*cos(x(1)+x(2))+(-2).*COPfx.*ls.*sin(\
x(2))+(-2).*COPfx.*lt.*sin(x(1)+x(2))).^(-3/2).*(2.*lt.*((-1).*la.*cos(x(1)+x(\
2))+COPfx.*sin(x(1)+x(2))).*(COPfx.^2+la.^2+ls.^2+lt.^2+2.*ls.*lt.*cos(x(1))+\
2.*la.*ls.*cos(x(2))+2.*la.*lt.*cos(x(1)+x(2))+(-2).*COPfx.*ls.*sin(x(2))+(-2)\
.*COPfx.*lt.*sin(x(1)+x(2)))+(-2).*lt.*(COPfx.*cos(x(1)+x(2))+ls.*sin(x(1))+\
la.*sin(x(1)+x(2))).*(COPfx.*ls.*cos(x(2))+COPfx.*lt.*cos(x(1)+x(2))+la.*ls.*\
sin(x(2))+la.*lt.*sin(x(1)+x(2)))),(1/2).*(COPfx.^2+la.^2+ls.^2+lt.^2+2.*ls.*\
lt.*cos(x(1))+2.*la.*ls.*cos(x(2))+2.*la.*lt.*cos(x(1)+x(2))+(-2).*COPfx.*ls.*\
sin(x(2))+(-2).*COPfx.*lt.*sin(x(1)+x(2))).^(-3/2).*(2.*(COPfx.^2+la.^2+ls.^2+\
lt.^2+2.*ls.*lt.*cos(x(1))+2.*la.*ls.*cos(x(2))+2.*la.*lt.*cos(x(1)+x(2))+(-2)\
.*COPfx.*ls.*sin(x(2))+(-2).*COPfx.*lt.*sin(x(1)+x(2))).*((-1).*la.*ls.*cos(x(\
2))+(-1).*la.*lt.*cos(x(1)+x(2))+COPfx.*ls.*sin(x(2))+COPfx.*lt.*sin(x(1)+x(2)\
))+(-2).*(COPfx.*ls.*cos(x(2))+COPfx.*lt.*cos(x(1)+x(2))+la.*ls.*sin(x(2))+la.\
*lt.*sin(x(1)+x(2))).^2)];\\n\"\>"], "Output",
 CellChangeTimes->{3.8070308759190316`*^9, 3.807030953915016*^9, 
  3.8070310274077015`*^9, 3.8070316372052517`*^9, 3.807031808771908*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{"Jc", ",", "JC"}], "]"}]], "Input",
 CellChangeTimes->{{3.807030836835327*^9, 3.8070308392280345`*^9}}],

Cell[BoxData["\<\"JC=[lc+(-1).*ls+lt+ls.*cos(x(2)),(-1).*ls.*sin(x(2)),0,0,0,\
1;lc+(-1).*ls+lt,0,0,0,0,1];\\n\"\>"], "Output",
 CellChangeTimes->{3.8070308759620275`*^9, 3.8070309539580135`*^9, 
  3.807031027459704*^9, 3.8070316372312517`*^9, 3.807031808819909*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{"ML", ",", "Ml"}], "]"}]], "Input",
 CellChangeTimes->{{3.807031554693798*^9, 3.8070315785929203`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Dot", "::", "dotsh"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Tensors \[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"-\\\", FractionBox[RowBox[{\\\"lt\\\", \
\\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"COPfx\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"ls\\\", \\\" \\\", RowBox[{\\\
\"Sin\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \\\"1\\\", \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"la\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]}], \\\"]\\\"}]}]}], \\\")\\\"}]}], \
SqrtBox[RowBox[{SuperscriptBox[\\\"COPfx\\\", \\\"2\\\"], \\\"+\\\", \
SuperscriptBox[\\\"la\\\", \\\"2\\\"], \\\"+\\\", SuperscriptBox[\\\"ls\\\", \
\\\"2\\\"], \\\"+\\\", SuperscriptBox[\\\"lt\\\", \\\"2\\\"], \\\"+\\\", \
RowBox[{\\\"2\\\", \\\" \\\", \\\"ls\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"la\\\", \\\" \
\\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\
\"2\\\", \\\" \\\", \\\"la\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"-\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"COPfx\\\", \\\" \
\\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\"-\\\", RowBox[{\\\
\"2\\\", \\\" \\\", \\\"COPfx\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", RowBox[{\
\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}]}]]]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"-\
\\\", FractionBox[RowBox[{RowBox[{\\\"COPfx\\\", \\\" \\\", \\\"ls\\\", \\\" \
\\\", RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
\\\"2\\\", \\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"COPfx\\\", \\\" \
\\\", \\\"lt\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{RowBox[{\
\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"la\\\", \\\" \\\", \
\\\"ls\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"x\\\", \
\\\"[\\\", \\\"2\\\", \\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"la\\\
\", \\\" \\\", \\\"lt\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}]}]}], \
SqrtBox[RowBox[{SuperscriptBox[\\\"COPfx\\\", \\\"2\\\"], \\\"+\\\", \
SuperscriptBox[\\\"la\\\", \\\"2\\\"], \\\"+\\\", SuperscriptBox[\\\"ls\\\", \
\\\"2\\\"], \\\"+\\\", SuperscriptBox[\\\"lt\\\", \\\"2\\\"], \\\"+\\\", \
RowBox[{\\\"2\\\", \\\" \\\", \\\"ls\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"la\\\", \\\" \
\\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\
\"2\\\", \\\" \\\", \\\"la\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"-\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"COPfx\\\", \\\" \
\\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\"-\\\", RowBox[{\\\
\"2\\\", \\\" \\\", \\\"COPfx\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", RowBox[{\
\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}]}]]]}], \\\"}\\\"}]}], \\\"}\\\"}]\\)\[NoBreak] and \
\[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{FractionBox[RowBox[{\\\"4\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{SuperscriptBox[\\\"lfx\\\", \\\"2\\\"], \\\"+\\\", \
SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{\\\"lfy\\\", \\\"-\\\", \\\"ls\\\", \
\\\"+\\\", \\\"lt\\\"}], \\\")\\\"}], \\\"2\\\"]}], \\\")\\\"}]}], \
RowBox[{RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Power\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Times\\\", \\\"[\
\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}], \\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[\\\"ls\\\
\", \\\"2\\\"], \\\" \\\", \\\"Mf\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}]}]], \\\",\\\", \
FractionBox[RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"4\\\"}], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{SuperscriptBox[\\\"lfx\\\", \\\"2\\\"], \\\"+\\\", \
SuperscriptBox[RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\
\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"2\\\"]}], \\\")\\\
\"}]}], \\\"-\\\", RowBox[{\\\"4\\\", \\\" \\\", \\\"ls\\\", \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{\\\"lfy\\\", \\\"-\\\", \\\"ls\\\", \\\"+\\\", \
\\\"lt\\\"}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", \\\"2\\\", \\\"]\\\"}], \\\"]\\\"}]}], \
\\\"+\\\", RowBox[{\\\"4\\\", \\\" \\\", \\\"lfx\\\", \\\" \\\", \\\"ls\\\", \
\\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
\\\"2\\\", \\\"]\\\"}], \\\"]\\\"}]}]}], RowBox[{RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\
\"(\\\", RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}], \\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[\\\"ls\\\
\", \\\"2\\\"], \\\" \\\", \\\"Mf\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}]}]]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{FractionBox[RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"4\\\"}], \\\" \
\\\", RowBox[{\\\"(\\\", RowBox[{SuperscriptBox[\\\"lfx\\\", \\\"2\\\"], \
\\\"+\\\", SuperscriptBox[RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"2\\\"]}], \\\")\\\"}]}], \\\"-\\\", RowBox[{\\\"4\\\", \\\" \\\", \
\\\"ls\\\", \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"lfy\\\", \\\"-\\\", \
\\\"ls\\\", \\\"+\\\", \\\"lt\\\"}], \\\")\\\"}], \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \\\"2\\\", \
\\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"4\\\", \\\" \\\", \
\\\"lfx\\\", \\\" \\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \
\\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \\\"2\\\", \\\"]\\\"}], \
\\\"]\\\"}]}]}], RowBox[{RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Power\
\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Power\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}], \\\"+\\\", RowBox[{\
\\\"2\\\", \\\" \\\", SuperscriptBox[\\\"ls\\\", \\\"2\\\"], \\\" \\\", \
\\\"Mf\\\", \\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Times\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}]}]], \\\",\\\", FractionBox[RowBox[{\\\"4\\\", \\\" \\\", RowBox[{\
\\\"(\\\", RowBox[{FractionBox[RowBox[{SuperscriptBox[\\\"lt\\\", \\\"2\\\"], \
\\\" \\\", \\\"Ms\\\"}], \\\"4\\\"], \\\"+\\\", RowBox[{\\\"Mf\\\", \\\" \
\\\", SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{\\\"lfy\\\", \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \\\"lt\\\", \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}], \\\"2\\\"]}], \\\"+\\\
\", RowBox[{\\\"Mf\\\", \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{\
\\\"lfx\\\", \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}], \\\"2\\\"]}]}], \\\")\\\"}]}], RowBox[{\\\"Mf\\\", \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{RowBox[{SuperscriptBox[\\\"lt\\\", \\\"2\\\"], \
\\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Power\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}], \\\" \\\", \\\"Ms\\\"}], \\\"+\\\", RowBox[{\\\"4\\\", \\\" \\\", \
\\\"Mf\\\", \\\" \\\", SuperscriptBox[RowBox[{\\\"Plus\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"2\\\"]}]}], \\\")\\\"}]}]]}], \\\"}\\\"}]}], \\\"}\\\"}]\\)\
\[NoBreak] have incompatible shapes. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", \
ButtonNote -> \\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.8070316372682548`*^9, 3.8070318088729095`*^9}],

Cell[BoxData["\<\"Ml=PseudoInverse(Dot([(-1).*lt.*(COPfx.*cos(x(1)+x(2))+ls.*\
sin(x(1))+la.*sin(x(1)+x(2))).*(COPfx.^2+la.^2+ls.^2+lt.^2+2.*ls.*lt.*cos(x(1)\
)+2.*la.*ls.*cos(x(2))+2.*la.*lt.*cos(x(1)+x(2))+(-2).*COPfx.*ls.*sin(x(2))+(-\
2).*COPfx.*lt.*sin(x(1)+x(2))).^(-1/2);(-1).*(COPfx.^2+la.^2+ls.^2+lt.^2+2.*\
ls.*lt.*cos(x(1))+2.*la.*ls.*cos(x(2))+2.*la.*lt.*cos(x(1)+x(2))+(-2).*COPfx.*\
ls.*sin(x(2))+(-2).*COPfx.*lt.*sin(x(1)+x(2))).^(-1/2).*(COPfx.*ls.*cos(x(2))+\
COPfx.*lt.*cos(x(1)+x(2))+la.*ls.*sin(x(2))+la.*lt.*sin(x(1)+x(2)))],[4.*(lfx.\
^2+(lfy+(-1).*ls+lt).^2).*((lfx.^2+(lfy+(-1).*ls+lt).^2).*(2.*ls.^2.*Mf+lt.^2.\
*Ms)+2.*ls.^2.*Mf.*((lfx+(-1).*lfy+ls+(-1).*lt).*(lfx+lfy+(-1).*ls+lt).*cos(2.\
*x(2))+2.*lfx.*(lfy+(-1).*ls+lt).*sin(2.*x(2)))).^(-1),((-4).*(lfx.^2+(lfy+(-\
1).*ls+lt).^2)+(-4).*ls.*(lfy+(-1).*ls+lt).*cos(x(2))+4.*lfx.*ls.*sin(x(2))).*\
((lfx.^2+(lfy+(-1).*ls+lt).^2).*(2.*ls.^2.*Mf+lt.^2.*Ms)+2.*ls.^2.*Mf.*((lfx+(\
-1).*lfy+ls+(-1).*lt).*(lfx+lfy+(-1).*ls+lt).*cos(2.*x(2))+2.*lfx.*(lfy+(-1).*\
ls+lt).*sin(2.*x(2)))).^(-1);((-4).*(lfx.^2+(lfy+(-1).*ls+lt).^2)+(-4).*ls.*(\
lfy+(-1).*ls+lt).*cos(x(2))+4.*lfx.*ls.*sin(x(2))).*((lfx.^2+(lfy+(-1).*ls+lt)\
.^2).*(2.*ls.^2.*Mf+lt.^2.*Ms)+2.*ls.^2.*Mf.*((lfx+(-1).*lfy+ls+(-1).*lt).*(\
lfx+lfy+(-1).*ls+lt).*cos(2.*x(2))+2.*lfx.*(lfy+(-1).*ls+lt).*sin(2.*x(2)))).^\
(-1),4.*Mf.^(-1).*((1/4).*lt.^2.*Ms+Mf.*(lfy+(-1).*ls+lt+ls.*cos(x(2))).^2+Mf.\
*(lfx+(-1).*ls.*sin(x(2))).^2).*(lt.^2.*(lfx.^2+(lfy+(-1).*ls+lt).^2).*Ms+4.*\
Mf.*(lfx.*ls.*cos(x(2))+ls.*(lfy+(-1).*ls+lt).*sin(x(2))).^2).^(-1)]));\\n\"\>\
"], "Output",
 CellChangeTimes->{3.8070316372992506`*^9, 3.8070318088989096`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ToMatlab", "[", 
  RowBox[{"BLinv", ",", "Blinv"}], "]"}]], "Input",
 CellChangeTimes->{{3.8070315845918922`*^9, 3.8070315911599007`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Dot", "::", "dotsh"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Tensors \[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"-\\\", FractionBox[RowBox[{\\\"lt\\\", \
\\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"COPfx\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"ls\\\", \\\" \\\", RowBox[{\\\
\"Sin\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \\\"1\\\", \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"la\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]}], \\\"]\\\"}]}]}], \\\")\\\"}]}], \
SqrtBox[RowBox[{SuperscriptBox[\\\"COPfx\\\", \\\"2\\\"], \\\"+\\\", \
SuperscriptBox[\\\"la\\\", \\\"2\\\"], \\\"+\\\", SuperscriptBox[\\\"ls\\\", \
\\\"2\\\"], \\\"+\\\", SuperscriptBox[\\\"lt\\\", \\\"2\\\"], \\\"+\\\", \
RowBox[{\\\"2\\\", \\\" \\\", \\\"ls\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"la\\\", \\\" \
\\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\
\"2\\\", \\\" \\\", \\\"la\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"-\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"COPfx\\\", \\\" \
\\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\"-\\\", RowBox[{\\\
\"2\\\", \\\" \\\", \\\"COPfx\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", RowBox[{\
\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}]}]]]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"-\
\\\", FractionBox[RowBox[{RowBox[{\\\"COPfx\\\", \\\" \\\", \\\"ls\\\", \\\" \
\\\", RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
\\\"2\\\", \\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"COPfx\\\", \\\" \
\\\", \\\"lt\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{RowBox[{\
\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"la\\\", \\\" \\\", \
\\\"ls\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"x\\\", \
\\\"[\\\", \\\"2\\\", \\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"la\\\
\", \\\" \\\", \\\"lt\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}]}]}], \
SqrtBox[RowBox[{SuperscriptBox[\\\"COPfx\\\", \\\"2\\\"], \\\"+\\\", \
SuperscriptBox[\\\"la\\\", \\\"2\\\"], \\\"+\\\", SuperscriptBox[\\\"ls\\\", \
\\\"2\\\"], \\\"+\\\", SuperscriptBox[\\\"lt\\\", \\\"2\\\"], \\\"+\\\", \
RowBox[{\\\"2\\\", \\\" \\\", \\\"ls\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"la\\\", \\\" \
\\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\
\"2\\\", \\\" \\\", \\\"la\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"-\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"COPfx\\\", \\\" \
\\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\"-\\\", RowBox[{\\\
\"2\\\", \\\" \\\", \\\"COPfx\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", RowBox[{\
\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}]}]]]}], \\\"}\\\"}]}], \\\"}\\\"}]\\)\[NoBreak] and \
\[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{FractionBox[RowBox[{\\\"4\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{SuperscriptBox[\\\"lfx\\\", \\\"2\\\"], \\\"+\\\", \
SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{\\\"lfy\\\", \\\"-\\\", \\\"ls\\\", \
\\\"+\\\", \\\"lt\\\"}], \\\")\\\"}], \\\"2\\\"]}], \\\")\\\"}]}], \
RowBox[{RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Power\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Times\\\", \\\"[\
\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}], \\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[\\\"ls\\\
\", \\\"2\\\"], \\\" \\\", \\\"Mf\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}]}]], \\\",\\\", \
FractionBox[RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"4\\\"}], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{SuperscriptBox[\\\"lfx\\\", \\\"2\\\"], \\\"+\\\", \
SuperscriptBox[RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\
\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"2\\\"]}], \\\")\\\
\"}]}], \\\"-\\\", RowBox[{\\\"4\\\", \\\" \\\", \\\"ls\\\", \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{\\\"lfy\\\", \\\"-\\\", \\\"ls\\\", \\\"+\\\", \
\\\"lt\\\"}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", \\\"2\\\", \\\"]\\\"}], \\\"]\\\"}]}], \
\\\"+\\\", RowBox[{\\\"4\\\", \\\" \\\", \\\"lfx\\\", \\\" \\\", \\\"ls\\\", \
\\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
\\\"2\\\", \\\"]\\\"}], \\\"]\\\"}]}]}], RowBox[{RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\
\"(\\\", RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}], \\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[\\\"ls\\\
\", \\\"2\\\"], \\\" \\\", \\\"Mf\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}]}]]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{FractionBox[RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"4\\\"}], \\\" \
\\\", RowBox[{\\\"(\\\", RowBox[{SuperscriptBox[\\\"lfx\\\", \\\"2\\\"], \
\\\"+\\\", SuperscriptBox[RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"2\\\"]}], \\\")\\\"}]}], \\\"-\\\", RowBox[{\\\"4\\\", \\\" \\\", \
\\\"ls\\\", \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"lfy\\\", \\\"-\\\", \
\\\"ls\\\", \\\"+\\\", \\\"lt\\\"}], \\\")\\\"}], \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \\\"2\\\", \
\\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"4\\\", \\\" \\\", \
\\\"lfx\\\", \\\" \\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \
\\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \\\"2\\\", \\\"]\\\"}], \
\\\"]\\\"}]}]}], RowBox[{RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Power\
\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Power\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}], \\\"+\\\", RowBox[{\
\\\"2\\\", \\\" \\\", SuperscriptBox[\\\"ls\\\", \\\"2\\\"], \\\" \\\", \
\\\"Mf\\\", \\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Times\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}]}]], \\\",\\\", FractionBox[RowBox[{\\\"4\\\", \\\" \\\", RowBox[{\
\\\"(\\\", RowBox[{FractionBox[RowBox[{SuperscriptBox[\\\"lt\\\", \\\"2\\\"], \
\\\" \\\", \\\"Ms\\\"}], \\\"4\\\"], \\\"+\\\", RowBox[{\\\"Mf\\\", \\\" \
\\\", SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{\\\"lfy\\\", \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \\\"lt\\\", \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}], \\\"2\\\"]}], \\\"+\\\
\", RowBox[{\\\"Mf\\\", \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{\
\\\"lfx\\\", \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}], \\\"2\\\"]}]}], \\\")\\\"}]}], RowBox[{\\\"Mf\\\", \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{RowBox[{SuperscriptBox[\\\"lt\\\", \\\"2\\\"], \
\\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Power\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}], \\\" \\\", \\\"Ms\\\"}], \\\"+\\\", RowBox[{\\\"4\\\", \\\" \\\", \
\\\"Mf\\\", \\\" \\\", SuperscriptBox[RowBox[{\\\"Plus\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"2\\\"]}]}], \\\")\\\"}]}]]}], \\\"}\\\"}]}], \\\"}\\\"}]\\)\
\[NoBreak] have incompatible shapes. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", \
ButtonNote -> \\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.8070316374092503`*^9, 3.807031808949911*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Dot", "::", "dotsh"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Tensors \[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"-\\\", FractionBox[RowBox[{\\\"lt\\\", \
\\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"COPfx\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"ls\\\", \\\" \\\", RowBox[{\\\
\"Sin\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \\\"1\\\", \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"la\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \
\\\"[\\\", RowBox[{RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]}], \\\"]\\\"}]}]}], \\\")\\\"}]}], \
SqrtBox[RowBox[{SuperscriptBox[\\\"COPfx\\\", \\\"2\\\"], \\\"+\\\", \
SuperscriptBox[\\\"la\\\", \\\"2\\\"], \\\"+\\\", SuperscriptBox[\\\"ls\\\", \
\\\"2\\\"], \\\"+\\\", SuperscriptBox[\\\"lt\\\", \\\"2\\\"], \\\"+\\\", \
RowBox[{\\\"2\\\", \\\" \\\", \\\"ls\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"la\\\", \\\" \
\\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\
\"2\\\", \\\" \\\", \\\"la\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"-\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"COPfx\\\", \\\" \
\\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\"-\\\", RowBox[{\\\
\"2\\\", \\\" \\\", \\\"COPfx\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", RowBox[{\
\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}]}]]]}], \\\"}\\\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"-\
\\\", FractionBox[RowBox[{RowBox[{\\\"COPfx\\\", \\\" \\\", \\\"ls\\\", \\\" \
\\\", RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
\\\"2\\\", \\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"COPfx\\\", \\\" \
\\\", \\\"lt\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{RowBox[{\
\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}]}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"la\\\", \\\" \\\", \
\\\"ls\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"x\\\", \
\\\"[\\\", \\\"2\\\", \\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"la\\\
\", \\\" \\\", \\\"lt\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \
RowBox[{RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \
\\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\"]\\\"}]}]}], \
SqrtBox[RowBox[{SuperscriptBox[\\\"COPfx\\\", \\\"2\\\"], \\\"+\\\", \
SuperscriptBox[\\\"la\\\", \\\"2\\\"], \\\"+\\\", SuperscriptBox[\\\"ls\\\", \
\\\"2\\\"], \\\"+\\\", SuperscriptBox[\\\"lt\\\", \\\"2\\\"], \\\"+\\\", \
RowBox[{\\\"2\\\", \\\" \\\", \\\"ls\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"1\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"la\\\", \\\" \
\\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\
\"2\\\", \\\" \\\", \\\"la\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}], \\\"-\\\", RowBox[{\\\"2\\\", \\\" \\\", \\\"COPfx\\\", \\\" \
\\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"1\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"]\\\"}]}], \\\"-\\\", RowBox[{\\\
\"2\\\", \\\" \\\", \\\"COPfx\\\", \\\" \\\", \\\"lt\\\", \\\" \\\", RowBox[{\
\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"]\\\"}]}]}]]]}], \\\"}\\\"}]}], \\\"}\\\"}]\\)\[NoBreak] and \
\[NoBreak]\\!\\(\\*RowBox[{\\\"{\\\", RowBox[{RowBox[{\\\"{\\\", \
RowBox[{FractionBox[RowBox[{\\\"4\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{SuperscriptBox[\\\"lfx\\\", \\\"2\\\"], \\\"+\\\", \
SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{\\\"lfy\\\", \\\"-\\\", \\\"ls\\\", \
\\\"+\\\", \\\"lt\\\"}], \\\")\\\"}], \\\"2\\\"]}], \\\")\\\"}]}], \
RowBox[{RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Power\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Times\\\", \\\"[\
\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \
\\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}], \\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[\\\"ls\\\
\", \\\"2\\\"], \\\" \\\", \\\"Mf\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}]}]], \\\",\\\", \
FractionBox[RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"4\\\"}], \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{SuperscriptBox[\\\"lfx\\\", \\\"2\\\"], \\\"+\\\", \
SuperscriptBox[RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\
\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"2\\\"]}], \\\")\\\
\"}]}], \\\"-\\\", RowBox[{\\\"4\\\", \\\" \\\", \\\"ls\\\", \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{\\\"lfy\\\", \\\"-\\\", \\\"ls\\\", \\\"+\\\", \
\\\"lt\\\"}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"Cos\\\", \\\"[\\\", \
RowBox[{\\\"x\\\", \\\"[\\\", \\\"2\\\", \\\"]\\\"}], \\\"]\\\"}]}], \
\\\"+\\\", RowBox[{\\\"4\\\", \\\" \\\", \\\"lfx\\\", \\\" \\\", \\\"ls\\\", \
\\\" \\\", RowBox[{\\\"Sin\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \
\\\"2\\\", \\\"]\\\"}], \\\"]\\\"}]}]}], RowBox[{RowBox[{RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\
\"(\\\", RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}], \\\"+\\\", RowBox[{\\\"2\\\", \\\" \\\", SuperscriptBox[\\\"ls\\\
\", \\\"2\\\"], \\\" \\\", \\\"Mf\\\", \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"4\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}]}]]}], \\\"}\\\"}], \
\\\",\\\", RowBox[{\\\"{\\\", \
RowBox[{FractionBox[RowBox[{RowBox[{RowBox[{\\\"-\\\", \\\"4\\\"}], \\\" \
\\\", RowBox[{\\\"(\\\", RowBox[{SuperscriptBox[\\\"lfx\\\", \\\"2\\\"], \
\\\"+\\\", SuperscriptBox[RowBox[{\\\"Plus\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \
\\\"2\\\"]}], \\\")\\\"}]}], \\\"-\\\", RowBox[{\\\"4\\\", \\\" \\\", \
\\\"ls\\\", \\\" \\\", RowBox[{\\\"(\\\", RowBox[{\\\"lfy\\\", \\\"-\\\", \
\\\"ls\\\", \\\"+\\\", \\\"lt\\\"}], \\\")\\\"}], \\\" \\\", \
RowBox[{\\\"Cos\\\", \\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \\\"2\\\", \
\\\"]\\\"}], \\\"]\\\"}]}], \\\"+\\\", RowBox[{\\\"4\\\", \\\" \\\", \
\\\"lfx\\\", \\\" \\\", \\\"ls\\\", \\\" \\\", RowBox[{\\\"Sin\\\", \
\\\"[\\\", RowBox[{\\\"x\\\", \\\"[\\\", \\\"2\\\", \\\"]\\\"}], \
\\\"]\\\"}]}]}], RowBox[{RowBox[{RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Power\
\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\
\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Power\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}]}], \\\")\\\"}], \\\" \\\", RowBox[{\\\"(\\\", \
RowBox[{RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\
\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}]}], \\\"+\\\", RowBox[{\
\\\"2\\\", \\\" \\\", SuperscriptBox[\\\"ls\\\", \\\"2\\\"], \\\" \\\", \
\\\"Mf\\\", \\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Times\\\", \
\\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\
\"}], \\\"]\\\"}], \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"4\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}]}]}]], \\\",\\\", FractionBox[RowBox[{\\\"4\\\", \\\" \\\", RowBox[{\
\\\"(\\\", RowBox[{FractionBox[RowBox[{SuperscriptBox[\\\"lt\\\", \\\"2\\\"], \
\\\" \\\", \\\"Ms\\\"}], \\\"4\\\"], \\\"+\\\", RowBox[{\\\"Mf\\\", \\\" \
\\\", SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{\\\"lfy\\\", \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}], \\\"+\\\", \\\"lt\\\", \\\"+\\\", \
RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \
\\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\")\\\"}], \\\"2\\\"]}], \\\"+\\\
\", RowBox[{\\\"Mf\\\", \\\" \\\", SuperscriptBox[RowBox[{\\\"(\\\", RowBox[{\
\\\"lfx\\\", \\\"+\\\", RowBox[{\\\"Times\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"3\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}], \\\"2\\\"]}]}], \\\")\\\"}]}], RowBox[{\\\"Mf\\\", \\\" \\\", \
RowBox[{\\\"(\\\", RowBox[{RowBox[{SuperscriptBox[\\\"lt\\\", \\\"2\\\"], \
\\\" \\\", RowBox[{\\\"(\\\", RowBox[{RowBox[{\\\"Power\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"+\\\", RowBox[{\\\"Power\\\", \\\"[\\\", RowBox[{\\\"\
\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\\\"}]}], \\\
\")\\\"}], \\\" \\\", \\\"Ms\\\"}], \\\"+\\\", RowBox[{\\\"4\\\", \\\" \\\", \
\\\"Mf\\\", \\\" \\\", SuperscriptBox[RowBox[{\\\"Plus\\\", \\\"[\\\", \
RowBox[{\\\"\[LeftSkeleton]\\\", \\\"2\\\", \\\"\[RightSkeleton]\\\"}], \\\"]\
\\\"}], \\\"2\\\"]}]}], \\\")\\\"}]}]]}], \\\"}\\\"}]}], \\\"}\\\"}]\\)\
\[NoBreak] have incompatible shapes. \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Dot/dotsh\\\", \
ButtonNote -> \\\"Dot::dotsh\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.8070316374092503`*^9, 3.8070318089749413`*^9}],

Cell[BoxData["\<\"Blinv=PseudoInverse(Dot(PseudoInverse(Dot([(-1).*lt.*(COPfx.\
*cos(x(1)+x(2))+ls.*sin(x(1))+la.*sin(x(1)+x(2))).*(COPfx.^2+la.^2+ls.^2+lt.^\
2+2.*ls.*lt.*cos(x(1))+2.*la.*ls.*cos(x(2))+2.*la.*lt.*cos(x(1)+x(2))+(-2).*\
COPfx.*ls.*sin(x(2))+(-2).*COPfx.*lt.*sin(x(1)+x(2))).^(-1/2);(-1).*(COPfx.^2+\
la.^2+ls.^2+lt.^2+2.*ls.*lt.*cos(x(1))+2.*la.*ls.*cos(x(2))+2.*la.*lt.*cos(x(\
1)+x(2))+(-2).*COPfx.*ls.*sin(x(2))+(-2).*COPfx.*lt.*sin(x(1)+x(2))).^(-1/2).*\
(COPfx.*ls.*cos(x(2))+COPfx.*lt.*cos(x(1)+x(2))+la.*ls.*sin(x(2))+la.*lt.*sin(\
x(1)+x(2)))],[4.*(lfx.^2+(lfy+(-1).*ls+lt).^2).*((lfx.^2+(lfy+(-1).*ls+lt).^2)\
.*(2.*ls.^2.*Mf+lt.^2.*Ms)+2.*ls.^2.*Mf.*((lfx+(-1).*lfy+ls+(-1).*lt).*(lfx+\
lfy+(-1).*ls+lt).*cos(2.*x(2))+2.*lfx.*(lfy+(-1).*ls+lt).*sin(2.*x(2)))).^(-1)\
,((-4).*(lfx.^2+(lfy+(-1).*ls+lt).^2)+(-4).*ls.*(lfy+(-1).*ls+lt).*cos(x(2))+\
4.*lfx.*ls.*sin(x(2))).*((lfx.^2+(lfy+(-1).*ls+lt).^2).*(2.*ls.^2.*Mf+lt.^2.*\
Ms)+2.*ls.^2.*Mf.*((lfx+(-1).*lfy+ls+(-1).*lt).*(lfx+lfy+(-1).*ls+lt).*cos(2.*\
x(2))+2.*lfx.*(lfy+(-1).*ls+lt).*sin(2.*x(2)))).^(-1);((-4).*(lfx.^2+(lfy+(-1)\
.*ls+lt).^2)+(-4).*ls.*(lfy+(-1).*ls+lt).*cos(x(2))+4.*lfx.*ls.*sin(x(2))).*((\
lfx.^2+(lfy+(-1).*ls+lt).^2).*(2.*ls.^2.*Mf+lt.^2.*Ms)+2.*ls.^2.*Mf.*((lfx+(-\
1).*lfy+ls+(-1).*lt).*(lfx+lfy+(-1).*ls+lt).*cos(2.*x(2))+2.*lfx.*(lfy+(-1).*\
ls+lt).*sin(2.*x(2)))).^(-1),4.*Mf.^(-1).*((1/4).*lt.^2.*Ms+Mf.*(lfy+(-1).*ls+\
lt+ls.*cos(x(2))).^2+Mf.*(lfx+(-1).*ls.*sin(x(2))).^2).*(lt.^2.*(lfx.^2+(lfy+(\
-1).*ls+lt).^2).*Ms+4.*Mf.*(lfx.*ls.*cos(x(2))+ls.*(lfy+(-1).*ls+lt).*sin(x(2)\
)).^2).^(-1)])),[(-1).*lt.*(COPfx.*cos(x(1)+x(2))+ls.*sin(x(1))+la.*sin(x(1)+\
x(2))).*(COPfx.^2+la.^2+ls.^2+lt.^2+2.*ls.*lt.*cos(x(1))+2.*la.*ls.*cos(x(2))+\
2.*la.*lt.*cos(x(1)+x(2))+(-2).*COPfx.*ls.*sin(x(2))+(-2).*COPfx.*lt.*sin(x(1)\
+x(2))).^(-1/2);(-1).*(COPfx.^2+la.^2+ls.^2+lt.^2+2.*ls.*lt.*cos(x(1))+2.*la.*\
ls.*cos(x(2))+2.*la.*lt.*cos(x(1)+x(2))+(-2).*COPfx.*ls.*sin(x(2))+(-2).*\
COPfx.*lt.*sin(x(1)+x(2))).^(-1/2).*(COPfx.*ls.*cos(x(2))+COPfx.*lt.*cos(x(1)+\
x(2))+la.*ls.*sin(x(2))+la.*lt.*sin(x(1)+x(2)))],[4.*(lfx.^2+(lfy+(-1).*ls+lt)\
.^2).*((lfx.^2+(lfy+(-1).*ls+lt).^2).*(2.*ls.^2.*Mf+lt.^2.*Ms)+2.*ls.^2.*Mf.*(\
(lfx+(-1).*lfy+ls+(-1).*lt).*(lfx+lfy+(-1).*ls+lt).*cos(2.*x(2))+2.*lfx.*(lfy+\
(-1).*ls+lt).*sin(2.*x(2)))).^(-1),((-4).*(lfx.^2+(lfy+(-1).*ls+lt).^2)+(-4).*\
ls.*(lfy+(-1).*ls+lt).*cos(x(2))+4.*lfx.*ls.*sin(x(2))).*((lfx.^2+(lfy+(-1).*\
ls+lt).^2).*(2.*ls.^2.*Mf+lt.^2.*Ms)+2.*ls.^2.*Mf.*((lfx+(-1).*lfy+ls+(-1).*\
lt).*(lfx+lfy+(-1).*ls+lt).*cos(2.*x(2))+2.*lfx.*(lfy+(-1).*ls+lt).*sin(2.*x(\
2)))).^(-1);((-4).*(lfx.^2+(lfy+(-1).*ls+lt).^2)+(-4).*ls.*(lfy+(-1).*ls+lt).*\
cos(x(2))+4.*lfx.*ls.*sin(x(2))).*((lfx.^2+(lfy+(-1).*ls+lt).^2).*(2.*ls.^2.*\
Mf+lt.^2.*Ms)+2.*ls.^2.*Mf.*((lfx+(-1).*lfy+ls+(-1).*lt).*(lfx+lfy+(-1).*ls+\
lt).*cos(2.*x(2))+2.*lfx.*(lfy+(-1).*ls+lt).*sin(2.*x(2)))).^(-1),4.*Mf.^(-1).\
*((1/4).*lt.^2.*Ms+Mf.*(lfy+(-1).*ls+lt+ls.*cos(x(2))).^2+Mf.*(lfx+(-1).*ls.*\
sin(x(2))).^2).*(lt.^2.*(lfx.^2+(lfy+(-1).*ls+lt).^2).*Ms+4.*Mf.*(lfx.*ls.*\
cos(x(2))+ls.*(lfy+(-1).*ls+lt).*sin(x(2))).^2).^(-1)]));\\n\"\>"], "Output",
 CellChangeTimes->{3.807031637462251*^9, 3.80703180900091*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
Magnification:>0.9 Inherited,
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (February 25, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 504, 10, 74, "Subsubtitle"],
Cell[CellGroupData[{
Cell[1096, 36, 279, 4, 61, "Section"],
Cell[CellGroupData[{
Cell[1400, 44, 1079, 32, 170, "Input"],
Cell[2482, 78, 446, 9, 19, "Message"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[2977, 93, 204, 2, 61, "Section"],
Cell[CellGroupData[{
Cell[3206, 99, 2611, 47, 50, "Input"],
Cell[5820, 148, 1224, 21, 28, "Output"]
}, Open  ]],
Cell[7059, 172, 3763, 76, 130, "Input"],
Cell[10825, 250, 4610, 94, 210, "Input"],
Cell[15438, 346, 430, 12, 50, "Input"],
Cell[15871, 360, 2422, 54, 210, "Input"],
Cell[CellGroupData[{
Cell[18318, 418, 1348, 31, 70, "Input"],
Cell[19669, 451, 1192, 20, 21, "Message"],
Cell[20864, 473, 1100, 18, 19, "Message"],
Cell[21967, 493, 1192, 20, 21, "Message"],
Cell[23162, 515, 1100, 18, 19, "Message"]
}, Open  ]],
Cell[24277, 536, 808, 23, 70, "Input"],
Cell[25088, 561, 1126, 32, 90, "Input"],
Cell[CellGroupData[{
Cell[26239, 597, 2668, 57, 70, "Input"],
Cell[28910, 656, 1112, 33, 117, "Output"]
}, Open  ]],
Cell[30037, 692, 302, 6, 29, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[30376, 703, 213, 3, 61, "Section"],
Cell[CellGroupData[{
Cell[30614, 710, 221, 3, 35, "Subsubsection"],
Cell[30838, 715, 2110, 52, 50, "Input"],
Cell[CellGroupData[{
Cell[32973, 771, 628, 13, 29, "Input"],
Cell[33604, 786, 3782, 91, 70, "Output"]
}, Open  ]],
Cell[37401, 880, 120, 2, 29, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37558, 887, 216, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[37799, 894, 95, 2, 29, "Input"],
Cell[37897, 898, 1133, 16, 28, "Output"]
}, Open  ]],
Cell[39045, 917, 2876, 75, 90, "Input"],
Cell[CellGroupData[{
Cell[41946, 996, 300, 5, 29, "Input"],
Cell[42249, 1003, 2247, 62, 28, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[44545, 1071, 326, 4, 35, "Subsubsection"],
Cell[44874, 1077, 1844, 44, 70, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46755, 1126, 100, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[46880, 1131, 2525, 48, 50, "Input"],
Cell[49408, 1181, 2560, 60, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52005, 1246, 347, 10, 29, "Input"],
Cell[52355, 1258, 1450, 33, 40, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53854, 1297, 260, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[54139, 1304, 1924, 36, 50, "Input"],
Cell[56066, 1342, 1177, 22, 28, "Output"],
Cell[57246, 1366, 2666, 68, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59949, 1439, 2068, 42, 50, "Input"],
Cell[62020, 1483, 1596, 43, 52, "Output"],
Cell[63619, 1528, 2919, 78, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66575, 1611, 509, 12, 29, "Input"],
Cell[67087, 1625, 4422, 109, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71546, 1739, 495, 11, 29, "Input"],
Cell[72044, 1752, 17393, 420, 98, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89474, 2177, 1578, 25, 29, "Input"],
Cell[91055, 2204, 648, 12, 21, "Message"],
Cell[91706, 2218, 376, 10, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92119, 2233, 336, 8, 29, "Input"],
Cell[92458, 2243, 650, 12, 21, "Message"],
Cell[93111, 2257, 389, 10, 28, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93561, 2274, 167, 2, 61, "Section"],
Cell[93731, 2278, 195, 4, 50, "Input"],
Cell[93929, 2284, 1206, 38, 29, "Input"],
Cell[CellGroupData[{
Cell[95160, 2326, 158, 3, 29, "Input"],
Cell[95321, 2331, 815, 11, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96173, 2347, 190, 4, 50, InheritFromParent],
Cell[96366, 2353, 718, 10, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97121, 2368, 192, 4, 50, "Input"],
Cell[97316, 2374, 629, 9, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97982, 2388, 153, 3, 29, "Input"],
Cell[98138, 2393, 603, 9, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98778, 2407, 185, 4, 29, "Input"],
Cell[98966, 2413, 962, 13, 67, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[99965, 2431, 157, 3, 29, "Input"],
Cell[100125, 2436, 2331, 29, 200, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102493, 2470, 154, 3, 29, "Input"],
Cell[102650, 2475, 266, 3, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102953, 2483, 154, 3, 29, "Input"],
Cell[103110, 2488, 12449, 172, 147, "Message"],
Cell[115562, 2662, 1673, 21, 162, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117272, 2688, 162, 3, 29, "Input"],
Cell[117437, 2693, 12447, 172, 147, "Message"],
Cell[129887, 2867, 12449, 172, 147, "Message"],
Cell[142339, 3041, 3233, 40, 276, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

